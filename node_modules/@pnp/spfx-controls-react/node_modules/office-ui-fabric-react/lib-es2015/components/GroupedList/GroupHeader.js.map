{"version":3,"file":"GroupHeader.js","sourceRoot":"../src/","sources":["components/GroupedList/GroupHeader.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport {\r\n  BaseComponent,\r\n  css\r\n} from '../../Utilities';\r\nimport { IGroupDividerProps } from './GroupedList.types';\r\nimport { SelectionMode } from '../../utilities/selection/index';\r\nimport { Check } from '../../Check';\r\nimport { Icon } from '../../Icon';\r\nimport { GroupSpacer } from './GroupSpacer';\r\nimport { Spinner } from '../../Spinner';\r\nimport { FocusZone, FocusZoneDirection } from '../../FocusZone';\r\nimport * as stylesImport from './GroupHeader.scss';\r\nconst styles: any = stylesImport;\r\n\r\nexport interface IGroupHeaderState {\r\n  isCollapsed: boolean;\r\n  isLoadingVisible: boolean;\r\n}\r\n\r\nexport class GroupHeader extends BaseComponent<IGroupDividerProps, IGroupHeaderState> {\r\n  constructor(props: IGroupDividerProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      isCollapsed: (this.props.group && this.props.group.isCollapsed) as boolean,\r\n      isLoadingVisible: false\r\n    };\r\n  }\r\n\r\n  public componentWillReceiveProps(newProps: any): void {\r\n    if (newProps.group) {\r\n      const newCollapsed = newProps.group.isCollapsed;\r\n      const isGroupLoading = newProps.headerProps && newProps.headerProps.isGroupLoading;\r\n      const newLoadingVisible = !newCollapsed && isGroupLoading && isGroupLoading(newProps.group);\r\n\r\n      this.setState({\r\n        isCollapsed: newCollapsed,\r\n        isLoadingVisible: newLoadingVisible\r\n      });\r\n    }\r\n  }\r\n\r\n  public render(): JSX.Element | null {\r\n    let {\r\n      isCollapsedGroupSelectVisible\r\n    } = this.props;\r\n    const {\r\n      group,\r\n      groupLevel,\r\n      viewport,\r\n      selectionMode,\r\n      loadingText,\r\n      isSelected,\r\n      selected\r\n    } = this.props;\r\n    const { isCollapsed, isLoadingVisible } = this.state;\r\n\r\n    if (isCollapsedGroupSelectVisible === undefined) {\r\n      isCollapsedGroupSelectVisible = true;\r\n    }\r\n    const canSelectGroup = selectionMode === SelectionMode.multiple;\r\n    const isSelectionCheckVisible = canSelectGroup && (isCollapsedGroupSelectVisible || !(group && group.isCollapsed));\r\n    const currentlySelected = isSelected || selected;\r\n\r\n    if (!group) {\r\n      return null;\r\n    }\r\n    return (\r\n      <div\r\n        className={ css('ms-GroupHeader', styles.root, {\r\n          ['is-selected ' + styles.rootIsSelected]: currentlySelected\r\n        }) }\r\n        style={ viewport ? { minWidth: viewport.width } : {} }\r\n        onClick={ this._onHeaderClick }\r\n        aria-label={ group.ariaLabel || group.name }\r\n        data-is-focusable={ true }\r\n      >\r\n\r\n        <FocusZone className={ styles.groupHeaderContainer } direction={ FocusZoneDirection.horizontal }>\r\n\r\n          { isSelectionCheckVisible ? (\r\n            <button\r\n              type='button'\r\n              className={ css('ms-GroupHeader-check', styles.check) }\r\n              data-selection-toggle={ true }\r\n              onClick={ this._onToggleSelectGroupClick }\r\n            >\r\n              <Check checked={ currentlySelected } />\r\n            </button>\r\n          ) : (selectionMode !== SelectionMode.none ? GroupSpacer({ count: 1 }) : null)\r\n          }\r\n\r\n          { GroupSpacer({ count: groupLevel as number }) }\r\n\r\n          <div className={ css('ms-GroupHeader-dropIcon', styles.dropIcon) }>\r\n            <Icon iconName='Tag' />\r\n          </div>\r\n          <button\r\n            type='button'\r\n            className={ css('ms-GroupHeader-expand', styles.expand) }\r\n            onClick={ this._onToggleCollapse }\r\n          >\r\n            <Icon\r\n              className={ css(\r\n                isCollapsed && ('is-collapsed ' + styles.expandIsCollapsed)\r\n              ) }\r\n              iconName='ChevronDown'\r\n            />\r\n          </button>\r\n\r\n          <div className={ css('ms-GroupHeader-title', styles.title) }>\r\n            <span>{ group.name }</span>\r\n            {\r\n              // hasMoreData flag is set when grouping is throttled by SPO server which in turn resorts to regular\r\n              // sorting to simulate grouping behaviors, in which case group count is the number of items returned\r\n              // so far. That's the reason we need to use \"+\" to show we might have more items than count\r\n              // indicates.\r\n            }\r\n            <span className={ styles.headerCount }>({ group.count }{ group.hasMoreData && '+' })</span>\r\n          </div>\r\n\r\n          { isLoadingVisible && (\r\n            <Spinner label={ loadingText } />\r\n          ) }\r\n\r\n        </FocusZone>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _onToggleCollapse = (ev: React.MouseEvent<HTMLElement>): void => {\r\n    const { group, onToggleCollapse, isGroupLoading } = this.props;\r\n    const { isCollapsed } = this.state;\r\n\r\n    const newCollapsed = !isCollapsed;\r\n    const newLoadingVisible = !newCollapsed && isGroupLoading && isGroupLoading(group!);\r\n\r\n    this.setState({\r\n      isCollapsed: newCollapsed,\r\n      isLoadingVisible: newLoadingVisible as boolean\r\n    });\r\n    if (onToggleCollapse) {\r\n      onToggleCollapse(group!);\r\n    }\r\n\r\n    ev.stopPropagation();\r\n    ev.preventDefault();\r\n  }\r\n\r\n  private _onToggleSelectGroupClick = (ev: React.MouseEvent<HTMLElement>): void => {\r\n    const { onToggleSelectGroup, group } = this.props;\r\n\r\n    if (onToggleSelectGroup) {\r\n      onToggleSelectGroup(group!);\r\n    }\r\n\r\n    ev.preventDefault();\r\n    ev.stopPropagation();\r\n  }\r\n\r\n  private _onHeaderClick = (): void => {\r\n    const { group, onGroupHeaderClick, onToggleSelectGroup } = this.props;\r\n\r\n    if (onGroupHeaderClick) {\r\n      onGroupHeaderClick(group!);\r\n    } else if (onToggleSelectGroup) {\r\n      onToggleSelectGroup(group!);\r\n    }\r\n  }\r\n}\r\n"]}