var FieldCustomizerDistinctInstances =  (function () {
    function FieldCustomizerDistinctInstances(serverURL) {
        this._listName = 'TABTestFieldCustomizerListTest';
        this._expectedReplacementText = 'TEXT REPLACED BY FIELD CUSTOMIZER';
        this._numberOfRowsInList = 3;
    }
    FieldCustomizerDistinctInstances.prototype.TestName = function () {
        return 'FieldCustomizer: two distinct FCs';
    };
    FieldCustomizerDistinctInstances.prototype.TestOwner = function () {
        return 'patsppplat';
    };
    FieldCustomizerDistinctInstances.prototype.TestOwnerTeam = function () {
        return 'DevPlat\\SPFX';
    };
    FieldCustomizerDistinctInstances.prototype.TestIncludeScripts = function () {
        return [
            '<ProductScriptsLocation>msajaxbundle.debug.js',
            '<ProductScriptsLocation>sp.runtime.debug.js',
            '<ProductScriptsLocation>sp.debug.js',
            '<TestLocation>/TabTaskLib.debug.js',
            '<AzureTaskLibLocation>/sp-tab-tasklib.js'
        ];
    };
    FieldCustomizerDistinctInstances.prototype.TestSetup = function () {
        var azurePath = TAB.Settings.Get('AzurePath');
        var loaderUrl = azurePath + "/listview-host-assembly_default.js";
        SPTaskLib.PageUtil.SetDebugManifests({ loaderUrl: loaderUrl });
        TAB.Log.Comment('FieldCustomizer test start');
        SPTaskLib.ExtensionUtil.loadList(this._listName);
    };
    FieldCustomizerDistinctInstances.prototype.TestRun = function () {
        var _this = this;
        var customListPagePath = "/Lists/" + this._listName + "/AllItems.aspx";
        var fieldCustomizers = '{' +
            '"Percent":{"id":"c60bc741-08cf-4187-b914-39875486cb54"},' +
            '"Description":{' +
            '"id":"491c7c0f-88ad-4548-b943-b581ed4acec0",' +
            ("\"properties\": {\"replacementText\": \"" + this._expectedReplacementText + "\"}}") +
            '}';
        var spQueryParams = {
            loadSPFX: true,
            fieldCustomizers: fieldCustomizers,
            params: 'disableFeatures=851'
        };
        var pageUrl = SPTaskLib.PageUtil.CreatePageUrl(customListPagePath, spQueryParams);
        TAB.AddTask(TAB.LoadPage(pageUrl));
        TAB.AddTask(TAB.MakeTask(function () {
            SPTaskLib.Utilities.ClientFeatures.SetOverrideFeature(851, false); 
        }), TAB.MakeWaiter(function () {
            return TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='fieldCustomizerReplaceTextDataCell']").length === _this._numberOfRowsInList;
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Validating the FIRST Field Customizer');
            var percentFieldRows = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='fieldCustomizerDataContainer']");
            if (percentFieldRows.length !== _this._numberOfRowsInList) {
                TAB.Log.AddTaskFail('Row Fields for the FIRST Field Customizer (Percent) are not accurate');
            }
            for (var _i = 0, percentFieldRows_1 = percentFieldRows; _i < percentFieldRows_1.length; _i++) {
                var percentRow = percentFieldRows_1[_i];
                if (!(percentRow.innerText.trim() === 'test-field-customizer')) {
                    TAB.Log.AddTaskFail('innerText was not modified by the FIRST FieldCustomizer');
                }
            }
            TAB.Log.Comment('Validating the SECOND Field Customizer');
            var replacementFieldRows = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='fieldCustomizerReplaceTextDataCell']");
            if (replacementFieldRows.length !== _this._numberOfRowsInList) {
                TAB.Log.AddTaskFail('Row Fields for the SECOND Field Customizer (Description) are not accurate');
            }
            for (var _a = 0, replacementFieldRows_1 = replacementFieldRows; _a < replacementFieldRows_1.length; _a++) {
                var replacementText = replacementFieldRows_1[_a];
                if (!(replacementText.innerText.trim() === _this._expectedReplacementText)) {
                    TAB.Log.AddTaskFail('innerText was not modified by the SECOND FieldCustomizer');
                }
            }
        }));
        TAB.Log.AddTaskPass('Test complete');
    };
    return FieldCustomizerDistinctInstances;
}());
TabTest = FieldCustomizerDistinctInstances;
