{"version":3,"file":"ChoiceGroup.base.js","sourceRoot":"../src/","sources":["components/ChoiceGroup/ChoiceGroup.base.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\n\nimport { Label } from '../../Label';\nimport {\n  initializeComponentRef,\n  warnDeprecations,\n  warnMutuallyExclusive,\n  classNamesFunction,\n  find,\n  getId,\n  getNativeProps,\n  divProperties\n} from '../../Utilities';\nimport { IChoiceGroup, IChoiceGroupOption, IChoiceGroupProps, IChoiceGroupStyleProps, IChoiceGroupStyles } from './ChoiceGroup.types';\nimport { ChoiceGroupOption, OnChangeCallback, OnFocusCallback } from './ChoiceGroupOption/index';\n\nconst getClassNames = classNamesFunction<IChoiceGroupStyleProps, IChoiceGroupStyles>();\n\nexport interface IChoiceGroupState {\n  keyChecked: string | number;\n\n  /** Is true when the control has focus. */\n  keyFocused?: string | number;\n}\n\n/**\n * {@docCategory ChoiceGroup}\n */\nexport class ChoiceGroupBase extends React.Component<IChoiceGroupProps, IChoiceGroupState> implements IChoiceGroup {\n  public static defaultProps: IChoiceGroupProps = {\n    options: []\n  };\n\n  private _id: string;\n  private _labelId: string;\n  private _inputElement = React.createRef<HTMLInputElement>();\n  private focusedVars: { [key: string]: OnFocusCallback } = {};\n  private changedVars: { [key: string]: OnChangeCallback } = {};\n\n  constructor(props: IChoiceGroupProps) {\n    super(props);\n\n    initializeComponentRef(this);\n\n    if (process.env.NODE_ENV !== 'production') {\n      warnDeprecations('ChoiceGroup', props, { onChanged: 'onChange' });\n      warnMutuallyExclusive('ChoiceGroup', props, {\n        selectedKey: 'defaultSelectedKey'\n      });\n    }\n\n    const validDefaultSelectedKey: boolean = !!props.options && props.options.some(option => option.key === props.defaultSelectedKey);\n\n    this.state = {\n      keyChecked:\n        props.defaultSelectedKey === undefined || !validDefaultSelectedKey ? this._getKeyChecked(props)! : props.defaultSelectedKey,\n      keyFocused: undefined\n    };\n\n    this._id = getId('ChoiceGroup');\n    this._labelId = getId('ChoiceGroupLabel');\n  }\n\n  /**\n   * Gets the current checked option.\n   */\n  public get checkedOption(): IChoiceGroupOption | undefined {\n    const { options = [] } = this.props;\n    const { keyChecked: key } = this.state;\n    return find(options, (value: IChoiceGroupOption) => value.key === key);\n  }\n\n  public componentWillReceiveProps(newProps: IChoiceGroupProps): void {\n    const newKeyChecked = this._getKeyChecked(newProps);\n    const oldKeyChecked = this._getKeyChecked(this.props);\n\n    if (newKeyChecked !== oldKeyChecked) {\n      this.setState({\n        keyChecked: newKeyChecked!\n      });\n    }\n  }\n\n  public render(): JSX.Element {\n    const { className, theme, styles, options, label, required, disabled, name, role } = this.props;\n    const { keyChecked, keyFocused } = this.state;\n\n    const divProps = getNativeProps(this.props, divProperties, ['onChange', 'className', 'required']);\n\n    const classNames = getClassNames(styles!, {\n      theme: theme!,\n      className,\n      optionsContainIconOrImage: options!.some(option => Boolean(option.iconProps || option.imageSrc))\n    });\n\n    const ariaLabelledBy = this.props.ariaLabelledBy\n      ? this.props.ariaLabelledBy\n      : label\n      ? this._id + '-label'\n      : (this.props as any)['aria-labelledby'];\n\n    return (\n      <div role={role} className={classNames.applicationRole} {...divProps}>\n        <div className={classNames.root} role=\"radiogroup\" {...ariaLabelledBy && { 'aria-labelledby': ariaLabelledBy }}>\n          {label && (\n            <Label className={classNames.label} required={required} id={this._id + '-label'}>\n              {label}\n            </Label>\n          )}\n          <div className={classNames.flexContainer}>\n            {options!.map((option: IChoiceGroupOption) => {\n              const innerOptionProps = {\n                ...option,\n                focused: option.key === keyFocused,\n                checked: option.key === keyChecked,\n                disabled: option.disabled || disabled,\n                id: `${this._id}-${option.key}`,\n                labelId: `${this._labelId}-${option.key}`,\n                name: name || this._id,\n                required\n              };\n\n              return (\n                <ChoiceGroupOption\n                  key={option.key}\n                  onBlur={this._onBlur}\n                  onFocus={this._onFocus(option.key)}\n                  onChange={this._onChange(option.key)}\n                  {...innerOptionProps}\n                />\n              );\n            })}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  public focus() {\n    const { options } = this.props;\n    if (options) {\n      for (const option of options) {\n        const elementToFocus = document.getElementById(`${this._id}-${option.key}`);\n        if (elementToFocus && elementToFocus.getAttribute('data-is-focusable') === 'true') {\n          elementToFocus.focus(); // focus on checked or default focusable key\n          return;\n        }\n      }\n    }\n    if (this._inputElement.current) {\n      this._inputElement.current.focus();\n    }\n  }\n\n  private _onFocus = (key: string) =>\n    this.focusedVars[key]\n      ? this.focusedVars[key]\n      : (this.focusedVars[key] = (ev: React.FocusEvent<HTMLElement>, option: IChoiceGroupOption) => {\n          this.setState({\n            keyFocused: key,\n            keyChecked: this.state.keyChecked\n          });\n        });\n\n  private _onBlur = (ev: React.FocusEvent<HTMLElement>, option: IChoiceGroupOption) => {\n    this.setState({\n      keyFocused: undefined,\n      keyChecked: this.state.keyChecked\n    });\n  };\n\n  private _onChange = (key: string) =>\n    this.changedVars[key]\n      ? this.changedVars[key]\n      : (this.changedVars[key] = (evt, option: IChoiceGroupOption) => {\n          const { onChanged, onChange, selectedKey, options = [] } = this.props;\n\n          // Only manage state in uncontrolled scenarios.\n          if (selectedKey === undefined) {\n            this.setState({\n              keyChecked: key\n            });\n          }\n\n          const originalOption = find(options, (value: IChoiceGroupOption) => value.key === key);\n\n          // TODO: onChanged deprecated, remove else if after 07/17/2017 when onChanged has been removed.\n          if (onChange) {\n            onChange(evt, originalOption);\n          } else if (onChanged) {\n            onChanged(originalOption!);\n          }\n        });\n\n  private _getKeyChecked(props: IChoiceGroupProps): string | number | undefined {\n    if (props.selectedKey !== undefined) {\n      return props.selectedKey;\n    }\n\n    const { options = [] } = props;\n\n    const optionsChecked = options.filter((option: IChoiceGroupOption) => {\n      return option.checked;\n    });\n\n    if (optionsChecked.length === 0) {\n      return undefined;\n    } else {\n      return optionsChecked[0].key;\n    }\n  }\n}\n"]}