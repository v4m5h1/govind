{"version":3,"file":"ChoiceGroup.base.js","sourceRoot":"../src/","sources":["components/ChoiceGroup/ChoiceGroup.base.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\n\nimport { Label } from '../../Label';\nimport {\n  initializeComponentRef,\n  warnDeprecations,\n  warnMutuallyExclusive,\n  classNamesFunction,\n  find,\n  getId,\n  getNativeProps,\n  divProperties\n} from '../../Utilities';\nimport { IChoiceGroup, IChoiceGroupOption, IChoiceGroupProps, IChoiceGroupStyleProps, IChoiceGroupStyles } from './ChoiceGroup.types';\nimport { ChoiceGroupOption, OnChangeCallback, OnFocusCallback } from './ChoiceGroupOption/index';\n\nconst getClassNames = classNamesFunction<IChoiceGroupStyleProps, IChoiceGroupStyles>();\n\nexport interface IChoiceGroupState {\n  keyChecked: string | number;\n\n  /** Is true when the control has focus. */\n  keyFocused?: string | number;\n}\n\n/**\n * {@docCategory ChoiceGroup}\n */\nexport class ChoiceGroupBase extends React.Component<IChoiceGroupProps, IChoiceGroupState> implements IChoiceGroup {\n  public static defaultProps: IChoiceGroupProps = {\n    options: []\n  };\n\n  private _id: string;\n  private _labelId: string;\n  private _inputElement = React.createRef<HTMLInputElement>();\n  private focusedVars: { [key: string]: OnFocusCallback } = {};\n  private changedVars: { [key: string]: OnChangeCallback } = {};\n\n  constructor(props: IChoiceGroupProps) {\n    super(props);\n\n    initializeComponentRef(this);\n\n    if (process.env.NODE_ENV !== 'production') {\n      warnDeprecations('ChoiceGroup', props, { onChanged: 'onChange' });\n      warnMutuallyExclusive('ChoiceGroup', props, {\n        selectedKey: 'defaultSelectedKey'\n      });\n    }\n\n    const validDefaultSelectedKey: boolean = !!props.options && props.options.some(option => option.key === props.defaultSelectedKey);\n\n    this.state = {\n      keyChecked:\n        props.defaultSelectedKey === undefined || !validDefaultSelectedKey ? this._getKeyChecked(props)! : props.defaultSelectedKey,\n      keyFocused: undefined\n    };\n\n    this._id = getId('ChoiceGroup');\n    this._labelId = getId('ChoiceGroupLabel');\n  }\n\n  /**\n   * Gets the current checked option.\n   */\n  public get checkedOption(): IChoiceGroupOption | undefined {\n    const { options = [] } = this.props;\n    const { keyChecked: key } = this.state;\n    return find(options, (value: IChoiceGroupOption) => value.key === key);\n  }\n\n  public componentWillReceiveProps(newProps: IChoiceGroupProps): void {\n    const newKeyChecked = this._getKeyChecked(newProps);\n    const oldKeyChecked = this._getKeyChecked(this.props);\n\n    if (newKeyChecked !== oldKeyChecked) {\n      this.setState({\n        keyChecked: newKeyChecked!\n      });\n    }\n  }\n\n  public render(): JSX.Element {\n    const { className, theme, styles, options, label, required, disabled, name, role } = this.props;\n    const { keyChecked, keyFocused } = this.state;\n\n    const divProps = getNativeProps(this.props, divProperties, ['onChange', 'className', 'required']);\n\n    const classNames = getClassNames(styles!, {\n      theme: theme!,\n      className,\n      optionsContainIconOrImage: options!.some(option => Boolean(option.iconProps || option.imageSrc))\n    });\n\n    const ariaLabelledBy = this.props.ariaLabelledBy\n      ? this.props.ariaLabelledBy\n      : label\n      ? this._id + '-label'\n      : (this.props as any)['aria-labelledby'];\n\n    return (\n      <div role={role} className={classNames.applicationRole} {...divProps}>\n        <div className={classNames.root} role=\"radiogroup\" {...ariaLabelledBy && { 'aria-labelledby': ariaLabelledBy }}>\n          {label && (\n            <Label className={classNames.label} required={required} id={this._id + '-label'}>\n              {label}\n            </Label>\n          )}\n          <div className={classNames.flexContainer}>\n            {options!.map((option: IChoiceGroupOption) => {\n              const innerOptionProps = {\n                ...option,\n                focused: option.key === keyFocused,\n                checked: option.key === keyChecked,\n                disabled: option.disabled || disabled,\n                id: `${this._id}-${option.key}`,\n                labelId: `${this._labelId}-${option.key}`,\n                name: name || this._id,\n                required\n              };\n\n              return (\n                <ChoiceGroupOption\n                  key={option.key}\n                  onBlur={this._onBlur}\n                  onFocus={this._onFocus(option.key)}\n                  onChange={this._onChange(option.key)}\n                  {...innerOptionProps}\n                />\n              );\n            })}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  public focus() {\n    const { options } = this.props;\n    if (options) {\n      for (const option of options) {\n        const elementToFocus = document.getElementById(`${this._id}-${option.key}`);\n        if (elementToFocus && elementToFocus.getAttribute('data-is-focusable') === 'true') {\n          elementToFocus.focus(); // focus on checked or default focusable key\n          return;\n        }\n      }\n    }\n    if (this._inputElement.current) {\n      this._inputElement.current.focus();\n    }\n  }\n\n  private _onFocus = (key: string) =>\n    this.focusedVars[key]\n      ? this.focusedVars[key]\n      : (this.focusedVars[key] = (ev: React.FocusEvent<HTMLElement>, option: IChoiceGroupOption) => {\n          this.setState({\n            keyFocused: key,\n            keyChecked: this.state.keyChecked\n          });\n        });\n\n  private _onBlur = (ev: React.FocusEvent<HTMLElement>, option: IChoiceGroupOption) => {\n    this.setState({\n      keyFocused: undefined,\n      keyChecked: this.state.keyChecked\n    });\n  };\n\n  private _onChange = (key: string) =>\n    this.changedVars[key]\n      ? this.changedVars[key]\n      : (this.changedVars[key] = (evt, option: IChoiceGroupOption) => {\n          const { onChanged, onChange, selectedKey, options = [] } = this.props;\n\n          // Only manage state in uncontrolled scenarios.\n          if (selectedKey === undefined) {\n            this.setState({\n              keyChecked: key\n            });\n          }\n\n          const originalOption = find(options, (value: IChoiceGroupOption) => value.key === key);\n\n          // TODO: onChanged deprecated, remove else if after 07/17/2017 when onChanged has been removed.\n          if (onChange) {\n            onChange(evt, originalOption);\n          } else if (onChanged) {\n            onChanged(originalOption!);\n          }\n        });\n\n  private _getKeyChecked(props: IChoiceGroupProps): string | number | undefined {\n    if (props.selectedKey !== undefined) {\n      return props.selectedKey;\n    }\n\n    const { options = [] } = props;\n\n    const optionsChecked = options.filter((option: IChoiceGroupOption) => {\n      return option.checked;\n    });\n\n    if (optionsChecked.length === 0) {\n      return undefined;\n    } else {\n      return optionsChecked[0].key;\n    }\n  }\n}\n"]}