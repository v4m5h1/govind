{"version":3,"sources":["propertyFields/listPicker/PropertyFieldListPicker.ts"],"names":[],"mappings":";;AAAA,6BAA+B;AAC/B,oCAAsC;AACtC,8DAIoC;AACpC,6EAAwE;AACxE,uFAAkF;AAKlF;;GAEG;AACH;IA8BE;;OAEG;IACH,wCAAmB,eAAuB,EAAE,WAAkD;QA/B9F,0CAA0C;QACnC,SAAI,GAA0B,uCAAqB,CAAC,MAAM,CAAC;QAqB1D,aAAQ,GAAY,KAAK,CAAC;QAE1B,2BAAsB,GAAW,GAAG,CAAC;QAErC,mCAA8B,GAAY,KAAK,CAAC;QAMtD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACrC,IAAI,CAAC,cAAc,GAAG,eAAe,CAAC;QACtC,IAAI,CAAC,UAAU,GAAG,WAAW,CAAC;QAC9B,IAAI,CAAC,UAAU,CAAC,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC;QACzC,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC;QACvC,IAAI,CAAC,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC;QAC/B,IAAI,CAAC,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC;QACnC,IAAI,CAAC,cAAc,GAAG,WAAW,CAAC,cAAc,CAAC;QACjD,IAAI,CAAC,YAAY,GAAG,WAAW,CAAC,YAAY,CAAC;QAC7C,IAAI,CAAC,aAAa,GAAG,WAAW,CAAC,aAAa,CAAC;QAC/C,IAAI,CAAC,YAAY,GAAG,WAAW,CAAC,YAAY,CAAC;QAC7C,IAAI,CAAC,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC;QACnC,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC,WAAW,CAAC;QAC3C,IAAI,CAAC,aAAa,GAAG,WAAW,CAAC,aAAa,CAAC;QAC/C,IAAI,CAAC,eAAe,GAAG,WAAW,CAAC,eAAe,CAAC;QACnD,IAAI,CAAC,oBAAoB,GAAG,WAAW,CAAC,oBAAoB,CAAC;QAC7D,IAAI,CAAC,aAAa,GAAG,WAAW,CAAC,aAAa,CAAC;QAC/C,IAAI,CAAC,gBAAgB,GAAG,WAAW,CAAC,gBAAgB,CAAC;QACrD,IAAI,CAAC,gBAAgB,GAAG,WAAW,CAAC,UAAU,CAAC;QAC/C,IAAI,CAAC,GAAG,GAAG,WAAW,CAAC,GAAG,CAAC;QAC3B,IAAI,CAAC,iBAAiB,GAAG,WAAW,CAAC,iBAAiB,CAAC;QAEvD,EAAE,CAAC,CAAC,WAAW,CAAC,QAAQ,KAAK,IAAI,CAAC,CAAC,CAAC;YAClC,IAAI,CAAC,QAAQ,GAAG,WAAW,CAAC,QAAQ,CAAC;QACvC,CAAC;QACD,EAAE,CAAC,CAAC,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC;YACvC,IAAI,CAAC,sBAAsB,GAAG,WAAW,CAAC,sBAAsB,CAAC;QACnE,CAAC;IACH,CAAC;IAzCM,yDAAgB,GAAvB,UAAwB,YAAoB,EAAE,QAAa,EAAE,QAAa,IAAU,CAAC;IA2CrF;;OAEG;IACK,+CAAM,GAAd,UAAe,IAAiB,EAAE,GAAS,EAAE,cAAkE;QAC7G,IAAM,cAAc,GAAG;YACrB,KAAK,EAAE,IAAI,CAAC,KAAK;YACjB,cAAc,EAAE,IAAI,CAAC,cAAc;YACnC,OAAO,EAAE,IAAI,CAAC,OAAO;YACrB,cAAc,EAAE,IAAI,CAAC,cAAc;YACnC,YAAY,EAAE,IAAI,CAAC,YAAY;YAC/B,OAAO,EAAE,IAAI,CAAC,OAAO;YACrB,WAAW,EAAE,IAAI,CAAC,WAAW;YAC7B,aAAa,EAAE,IAAI,CAAC,aAAa;YACjC,SAAS,EAAE,IAAI,CAAC,OAAO;YACvB,QAAQ,EAAE,IAAI,CAAC,MAAM;YACrB,QAAQ,EAAE,cAAc;YACxB,gBAAgB,EAAE,IAAI,CAAC,gBAAgB;YACvC,UAAU,EAAE,IAAI,CAAC,gBAAgB;YACjC,GAAG,EAAE,IAAI,CAAC,GAAG;YACb,QAAQ,EAAE,IAAI,CAAC,QAAQ;YACvB,iBAAiB,EAAE,IAAI,CAAC,iBAAiB;YACzC,sBAAsB,EAAE,IAAI,CAAC,sBAAsB;SACpD,CAAC;QAEF,kEAAkE;QAClE,EAAE,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC;YACrB,iBAAiB;YACjB,cAAc,CAAC,eAAe,CAAC,GAAG,IAAI,CAAC,aAAa,CAAC;YACrD,cAAc,CAAC,eAAe,CAAC,GAAG,IAAI,CAAC,aAAa,CAAC;YACrD,cAAc,CAAC,iBAAiB,CAAC,GAAG,IAAI,CAAC,eAAe,CAAC;YACzD,cAAc,CAAC,sBAAsB,CAAC,GAAG,IAAI,CAAC,oBAAoB,CAAC;YACnE,IAAM,OAAO,GAA+D,KAAK,CAAC,aAAa,CAAC,0CAAgC,EAAE,cAAc,CAAC,CAAC;YAClJ,oCAAoC;YACpC,QAAQ,CAAC,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;QACjC,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,kBAAkB;YAClB,cAAc,CAAC,cAAc,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC;YACnD,IAAM,OAAO,GAA0D,KAAK,CAAC,aAAa,CAAC,qCAA2B,EAAE,cAAc,CAAC,CAAC;YACxI,oCAAoC;YACpC,QAAQ,CAAC,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;QACjC,CAAC;IACH,CAAC;IAED;;OAEG;IACK,gDAAO,GAAf,UAAgB,IAAiB;IAEjC,CAAC;IAEH,qCAAC;AAAD,CAlHA,AAkHC,IAAA;AAED;;;;GAIG;AACH,iCAAwC,cAAsB,EAAE,UAAyC;IAEvG,gEAAgE;IAChE,IAAM,aAAa,GAA0C;QAC3D,KAAK,EAAE,UAAU,CAAC,KAAK;QACvB,cAAc,EAAE,cAAc;QAC9B,OAAO,EAAE,UAAU,CAAC,OAAO;QAC3B,cAAc,EAAE,UAAU,CAAC,cAAc;QACzC,YAAY,EAAE,OAAO,UAAU,CAAC,YAAY,KAAK,QAAQ,GAAG,UAAU,CAAC,YAAY,GAAG,IAAI;QAC1F,aAAa,EAAE,OAAO,UAAU,CAAC,YAAY,KAAK,QAAQ,GAAG,UAAU,CAAC,YAAY,GAAG,IAAI;QAC3F,YAAY,EAAE,UAAU,CAAC,YAAY;QACrC,OAAO,EAAE,UAAU,CAAC,OAAO;QAC3B,WAAW,EAAE,UAAU,CAAC,WAAW,IAAI,KAAK;QAC5C,aAAa,EAAE,UAAU,CAAC,aAAa,IAAI,KAAK;QAChD,eAAe,EAAE,UAAU,CAAC,eAAe,IAAI,KAAK;QACpD,oBAAoB,EAAE,UAAU,CAAC,oBAAoB;QACrD,aAAa,EAAE,UAAU,CAAC,aAAa;QACvC,gBAAgB,EAAE,UAAU,CAAC,gBAAgB;QAC7C,UAAU,EAAE,UAAU,CAAC,UAAU;QACjC,SAAS,EAAE,IAAI;QACf,QAAQ,EAAE,IAAI;QACd,GAAG,EAAE,UAAU,CAAC,GAAG;QACnB,QAAQ,EAAE,UAAU,CAAC,QAAQ;QAC7B,iBAAiB,EAAE,UAAU,CAAC,iBAAiB;QAC/C,sBAAsB,EAAE,UAAU,CAAC,sBAAsB;KAC1D,CAAC;IACF,kDAAkD;IAClD,iFAAiF;IACjF,MAAM,CAAC,IAAI,8BAA8B,CAAC,cAAc,EAAE,aAAa,CAAC,CAAC;AAC3E,CAAC;AA7BD,0DA6BC","file":"propertyFields/listPicker/PropertyFieldListPicker.js","sourcesContent":["import * as React from 'react';\nimport * as ReactDom from 'react-dom';\nimport {\n  IPropertyPaneField,\n  PropertyPaneFieldType,\n  IWebPartContext\n} from '@microsoft/sp-webpart-base';\nimport PropertyFieldListPickerHost from './PropertyFieldListPickerHost';\nimport PropertyFieldListMultiPickerHost from './PropertyFieldListMultiPickerHost';\nimport { IPropertyFieldListPickerHostProps } from './IPropertyFieldListPickerHost';\nimport { IPropertyFieldListMultiPickerHostProps } from './IPropertyFieldListMultiPickerHost';\nimport { PropertyFieldListPickerOrderBy, IPropertyFieldListPickerProps, IPropertyFieldListPickerPropsInternal } from './IPropertyFieldListPicker';\n\n/**\n * Represents a PropertyFieldListPicker object\n */\nclass PropertyFieldListPickerBuilder implements IPropertyPaneField<IPropertyFieldListPickerPropsInternal> {\n\n  //Properties defined by IPropertyPaneField\n  public type: PropertyPaneFieldType = PropertyPaneFieldType.Custom;\n  public targetProperty: string;\n  public properties: IPropertyFieldListPickerPropsInternal;\n\n  //Custom properties label: string;\n  private label: string;\n  private context: IWebPartContext;\n  private webAbsoluteUrl?: string;\n  private selectedList: string;\n  private selectedLists: string[];\n  private baseTemplate: number;\n  private orderBy: PropertyFieldListPickerOrderBy;\n  private multiSelect: boolean;\n  private showSelectAll: boolean;\n  private selectAllInList: boolean;\n  private selectAllInListLabel: string;\n  private includeHidden: boolean;\n\n  public onPropertyChange(propertyPath: string, oldValue: any, newValue: any): void { }\n  private customProperties: any;\n  private key: string;\n  private disabled: boolean = false;\n  private onGetErrorMessage: (value: string) => string | Promise<string>;\n  private deferredValidationTime: number = 200;\n  private renderWebPart: () => void;\n  private disableReactivePropertyChanges: boolean = false;\n\n  /**\n   * Constructor method\n   */\n  public constructor(_targetProperty: string, _properties: IPropertyFieldListPickerPropsInternal) {\n    this.render = this.render.bind(this);\n    this.targetProperty = _targetProperty;\n    this.properties = _properties;\n    this.properties.onDispose = this.dispose;\n    this.properties.onRender = this.render;\n    this.label = _properties.label;\n    this.context = _properties.context;\n    this.webAbsoluteUrl = _properties.webAbsoluteUrl;\n    this.selectedList = _properties.selectedList;\n    this.selectedLists = _properties.selectedLists;\n    this.baseTemplate = _properties.baseTemplate;\n    this.orderBy = _properties.orderBy;\n    this.multiSelect = _properties.multiSelect;\n    this.showSelectAll = _properties.showSelectAll;\n    this.selectAllInList = _properties.selectAllInList;\n    this.selectAllInListLabel = _properties.selectAllInListLabel;\n    this.includeHidden = _properties.includeHidden;\n    this.onPropertyChange = _properties.onPropertyChange;\n    this.customProperties = _properties.properties;\n    this.key = _properties.key;\n    this.onGetErrorMessage = _properties.onGetErrorMessage;\n\n    if (_properties.disabled === true) {\n      this.disabled = _properties.disabled;\n    }\n    if (_properties.deferredValidationTime) {\n      this.deferredValidationTime = _properties.deferredValidationTime;\n    }\n  }\n\n  /**\n   * Renders the SPListPicker field content\n   */\n  private render(elem: HTMLElement, ctx?: any, changeCallback?: (targetProperty?: string, newValue?: any) => void): void {\n    const componentProps = {\n      label: this.label,\n      targetProperty: this.targetProperty,\n      context: this.context,\n      webAbsoluteUrl: this.webAbsoluteUrl,\n      baseTemplate: this.baseTemplate,\n      orderBy: this.orderBy,\n      multiSelect: this.multiSelect,\n      includeHidden: this.includeHidden,\n      onDispose: this.dispose,\n      onRender: this.render,\n      onChange: changeCallback,\n      onPropertyChange: this.onPropertyChange,\n      properties: this.customProperties,\n      key: this.key,\n      disabled: this.disabled,\n      onGetErrorMessage: this.onGetErrorMessage,\n      deferredValidationTime: this.deferredValidationTime\n    };\n\n    // Check if the multi or single select component has to get loaded\n    if (this.multiSelect) {\n      // Multi selector\n      componentProps['selectedLists'] = this.selectedLists;\n      componentProps['showSelectAll'] = this.showSelectAll;\n      componentProps['selectAllInList'] = this.selectAllInList;\n      componentProps['selectAllInListLabel'] = this.selectAllInListLabel;\n      const element: React.ReactElement<IPropertyFieldListMultiPickerHostProps> = React.createElement(PropertyFieldListMultiPickerHost, componentProps);\n      // Calls the REACT content generator\n      ReactDom.render(element, elem);\n    } else {\n      // Single selector\n      componentProps['selectedList'] = this.selectedList;\n      const element: React.ReactElement<IPropertyFieldListPickerHostProps> = React.createElement(PropertyFieldListPickerHost, componentProps);\n      // Calls the REACT content generator\n      ReactDom.render(element, elem);\n    }\n  }\n\n  /**\n   * Disposes the current object\n   */\n  private dispose(elem: HTMLElement): void {\n\n  }\n\n}\n\n/**\n * Helper method to create a SPList Picker on the PropertyPane.\n * @param targetProperty - Target property the SharePoint list picker is associated to.\n * @param properties - Strongly typed SPList Picker properties.\n */\nexport function PropertyFieldListPicker(targetProperty: string, properties: IPropertyFieldListPickerProps): IPropertyPaneField<IPropertyFieldListPickerPropsInternal> {\n\n  //Create an internal properties object from the given properties\n  const newProperties: IPropertyFieldListPickerPropsInternal = {\n    label: properties.label,\n    targetProperty: targetProperty,\n    context: properties.context,\n    webAbsoluteUrl: properties.webAbsoluteUrl,\n    selectedList: typeof properties.selectedList === 'string' ? properties.selectedList : null,\n    selectedLists: typeof properties.selectedList !== 'string' ? properties.selectedList : null,\n    baseTemplate: properties.baseTemplate,\n    orderBy: properties.orderBy,\n    multiSelect: properties.multiSelect || false,\n    showSelectAll: properties.showSelectAll || false,\n    selectAllInList: properties.selectAllInList || false,\n    selectAllInListLabel: properties.selectAllInListLabel,\n    includeHidden: properties.includeHidden,\n    onPropertyChange: properties.onPropertyChange,\n    properties: properties.properties,\n    onDispose: null,\n    onRender: null,\n    key: properties.key,\n    disabled: properties.disabled,\n    onGetErrorMessage: properties.onGetErrorMessage,\n    deferredValidationTime: properties.deferredValidationTime\n  };\n  //Calls the PropertyFieldListPicker builder object\n  //This object will simulate a PropertyFieldCustom to manage his rendering process\n  return new PropertyFieldListPickerBuilder(targetProperty, newProperties);\n}\n"],"sourceRoot":"../../../src"}