import { ServiceKey } from '@microsoft/sp-core-library';
import MSGraphClient from './MSGraphClient';
var MSGraphClientFactory =  (function () {
    function MSGraphClientFactory(serviceScope) {
        this._serviceScope = serviceScope;
    }
    MSGraphClientFactory.prototype.getClient = function () {
        var _this = this;
        if (!MSGraphClient._instance) {
            return import( '@microsoft/microsoft-graph-client/lib/graph-js-sdk-web')
                .then(function () {
                return new MSGraphClient(_this._serviceScope);
            });
        }
        else {
            return Promise.resolve(new MSGraphClient(this._serviceScope));
        }
    };
    MSGraphClientFactory.serviceKey = ServiceKey.create('sp-http:MSGraphClientFactory', MSGraphClientFactory);
    return MSGraphClientFactory;
}());
export default MSGraphClientFactory;
