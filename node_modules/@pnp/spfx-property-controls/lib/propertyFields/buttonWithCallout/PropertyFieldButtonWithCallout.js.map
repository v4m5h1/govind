{"version":3,"sources":["propertyFields/buttonWithCallout/PropertyFieldButtonWithCallout.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,6BAA+B;AAC/B,oCAAsC;AACtC,8DAIoC;AAEpC,2FAA2E;AAG3E,uEAA0E;AAC1E,iCAA8B;AAE9B;;GAEG;AACH;IAMI,+CAAmB,eAAuB,EAAE,WAAyD;QAJ9F,SAAI,GAA0B,uCAAqB,CAAC,MAAM,CAAC;QAK9D,IAAI,CAAC,cAAc,GAAG,eAAe,CAAC;QACtC,IAAI,CAAC,UAAU,GAAG,WAAW,CAAC;QAE9B,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACnD,IAAI,CAAC,UAAU,CAAC,SAAS,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACzD,CAAC;IAEO,uDAAO,GAAf,UAAgB,IAAiB,EAAE,OAAa,EAAE,cAAkE;QAEhH,IAAM,KAAK,GAA+E,aAAI,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC,YAAY,CAAC,CAAC,CAAC;QAEhI,EAAE;QACF,yDAAyD;QACzD,EAAE;QACF,IAAM,gBAAgB,GAAW,mBAAU,CAAC,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;QACxE,IAAM,UAAU,GAAe,mBAAU,CAAC,gBAAgB,CAAC,CAAC;QAC5D,IAAM,eAAe,GAAG,aAAI,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;QAC3C,IAAM,OAAO,GAAG,KAAK,CAAC,aAAa,CAAC,4CAAuB,eACpD,eAAe,IAClB,UAAU,EAAE,UAAU,IACxB,CAAC;QAEH,QAAQ,CAAC,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;IACnC,CAAC;IAEO,wDAAQ,GAAhB,UAAiB,IAAiB;QAC9B,QAAQ,CAAC,sBAAsB,CAAC,IAAI,CAAC,CAAC;IAC1C,CAAC;IACL,4CAAC;AAAD,CAnCA,AAmCC,IAAA;AAED;;;;GAIG;AACH,wCAA+C,cAAsB,EAAE,UAAgD;IACnH,MAAM,CAAC,IAAI,qCAAqC,CAAC,cAAc,eACxD,UAAU,IACb,QAAQ,EAAE,IAAI,EACd,SAAS,EAAE,IAAI,IACjB,CAAC;AACP,CAAC;AAND,wEAMC","file":"propertyFields/buttonWithCallout/PropertyFieldButtonWithCallout.js","sourcesContent":["import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport {\n    IPropertyPaneField,\n    PropertyPaneFieldType,\n    PropertyPaneButtonType\n} from '@microsoft/sp-webpart-base';\n\nimport PropertyFieldButtonHost from './PropertyFieldButtonWithCalloutHost';\n\nimport { IPropertyFieldButtonWithCalloutPropsInternal, IPropertyFieldButtonWithCalloutProps } from './IPropertyFieldButtonWithCallout';\nimport { ButtonType } from 'office-ui-fabric-react/lib/components/Button';\nimport { omit } from 'lodash';\n\n/**\n * Represents a PropertyFieldButtonWithCallout object\n */\nclass PropertyFieldButtonWithCalloutBuilder implements IPropertyPaneField<IPropertyFieldButtonWithCalloutPropsInternal> {\n    public targetProperty: string;\n    public type: PropertyPaneFieldType = PropertyPaneFieldType.Custom;\n    public properties: IPropertyFieldButtonWithCalloutPropsInternal;\n\n\n    public constructor(_targetProperty: string, _properties: IPropertyFieldButtonWithCalloutPropsInternal) {\n        this.targetProperty = _targetProperty;\n        this.properties = _properties;\n\n        this.properties.onRender = this._render.bind(this);\n        this.properties.onDispose = this._dispose.bind(this);\n    }\n\n    private _render(elem: HTMLElement, context?: any, changeCallback?: (targetProperty?: string, newValue?: any) => void): void {\n\n        const props: IPropertyFieldButtonWithCalloutProps = <IPropertyFieldButtonWithCalloutProps>omit(this.properties, ['buttonType']);\n\n        //\n        // PropertyPaneButtonType is not assignable to ButtonType\n        //\n        const buttonTypeString: string = ButtonType[this.properties.buttonType];\n        const buttonType: ButtonType = ButtonType[buttonTypeString];\n        const propsWithoutRef = omit(props, \"ref\");\n        const element = React.createElement(PropertyFieldButtonHost, {\n            ...propsWithoutRef,\n            buttonType: buttonType\n        });\n\n        ReactDOM.render(element, elem);\n    }\n\n    private _dispose(elem: HTMLElement) {\n        ReactDOM.unmountComponentAtNode(elem);\n    }\n}\n\n/**\n * Helper method to create a Button with Callout component on the PropertyPane.\n * @param targetProperty - Target property the Button with Callout component is associated to.\n * @param properties - Strongly typed Button with Callout component properties.\n */\nexport function PropertyFieldButtonWithCallout(targetProperty: string, properties: IPropertyFieldButtonWithCalloutProps): IPropertyPaneField<IPropertyFieldButtonWithCalloutPropsInternal> {\n    return new PropertyFieldButtonWithCalloutBuilder(targetProperty, {\n        ...properties,\n        onRender: null,\n        onDispose: null\n    });\n}\n"],"sourceRoot":"../../../src"}