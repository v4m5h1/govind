define("c07208f0-ea3b-4c1a-9965-ac1b825211a6_1.8.2", ["@microsoft/sp-core-library","@microsoft/sp-diagnostics"], function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_2__) { return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(1),__webpack_require__(2),__webpack_require__(3)], __WEBPACK_AMD_DEFINE_RESULT__ = (function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_3__) { return /******/ (function(modules) { // webpackBootstrap
/******/ 	// install a JSONP callback for chunk loading
/******/ 	var parentJsonpFunction = window["webpackJsonpc07208f0_ea3b_4c1a_9965_ac1b825211a6_1_8_2"];
/******/ 	window["webpackJsonpc07208f0_ea3b_4c1a_9965_ac1b825211a6_1_8_2"] = function webpackJsonpCallback(chunkIds, moreModules, executeModules) {
/******/ 		// add "moreModules" to the modules object,
/******/ 		// then flag all "chunkIds" as loaded and fire callback
/******/ 		var moduleId, chunkId, i = 0, resolves = [], result;
/******/ 		for(;i < chunkIds.length; i++) {
/******/ 			chunkId = chunkIds[i];
/******/ 			if(installedChunks[chunkId]) {
/******/ 				resolves.push(installedChunks[chunkId][0]);
/******/ 			}
/******/ 			installedChunks[chunkId] = 0;
/******/ 		}
/******/ 		for(moduleId in moreModules) {
/******/ 			if(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {
/******/ 				modules[moduleId] = moreModules[moduleId];
/******/ 			}
/******/ 		}
/******/ 		if(parentJsonpFunction) parentJsonpFunction(chunkIds, moreModules, executeModules);
/******/ 		while(resolves.length) {
/******/ 			resolves.shift()();
/******/ 		}
/******/
/******/ 	};
/******/
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// objects to store loaded and loading chunks
/******/ 	var installedChunks = {
/******/ 		2: 0
/******/ 	};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/ 	// This file contains only the entry chunk.
/******/ 	// The chunk loading function for additional chunks
/******/ 	__webpack_require__.e = function requireEnsure(chunkId) {
/******/ 		var installedChunkData = installedChunks[chunkId];
/******/ 		if(installedChunkData === 0) {
/******/ 			return new Promise(function(resolve) { resolve(); });
/******/ 		}
/******/
/******/ 		// a Promise means "currently loading".
/******/ 		if(installedChunkData) {
/******/ 			return installedChunkData[2];
/******/ 		}
/******/
/******/ 		// setup Promise in chunk cache
/******/ 		var promise = new Promise(function(resolve, reject) {
/******/ 			installedChunkData = installedChunks[chunkId] = [resolve, reject];
/******/ 		});
/******/ 		installedChunkData[2] = promise;
/******/
/******/ 		// start chunk loading
/******/ 		var head = document.getElementsByTagName('head')[0];
/******/ 		var script = document.createElement('script');
/******/ 		script.type = "text/javascript";
/******/ 		script.charset = 'utf-8';
/******/ 		script.async = true;
/******/ 		script.timeout = 120000;
/******/
/******/ 		if (__webpack_require__.nc) {
/******/ 			script.setAttribute("nonce", __webpack_require__.nc);
/******/ 		}
/******/ 		script.src = __webpack_require__.p + "" + chunkId + "." + ({}[chunkId]||chunkId) + "_" + {"0":"376ed22038b31d9b5ec6","1":"881065da9f3d4035ce78"}[chunkId] + ".js";
/******/ 		var timeout = setTimeout(onScriptComplete, 120000);
/******/ 		script.onerror = script.onload = onScriptComplete;
/******/ 		function onScriptComplete() {
/******/ 			// avoid mem leaks in IE.
/******/ 			script.onerror = script.onload = null;
/******/ 			clearTimeout(timeout);
/******/ 			var chunk = installedChunks[chunkId];
/******/ 			if(chunk !== 0) {
/******/ 				if(chunk) {
/******/ 					chunk[1](new Error('Loading chunk ' + chunkId + ' failed.'));
/******/ 				}
/******/ 				installedChunks[chunkId] = undefined;
/******/ 			}
/******/ 		};
/******/ 		head.appendChild(script);
/******/
/******/ 		return promise;
/******/ 	};
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// on error function for async loading
/******/ 	__webpack_require__.oe = function(err) { console.error(err); throw err; };
/******/
/******/ 	// Set the webpack public path
/******/ 	(function () {
/******/ 	  var scripts = document.getElementsByTagName('script');
/******/ 	  var regex = (typeof spScriptNamePattern !== 'undefined') ? spScriptNamePattern : new RegExp('\\/sp-http(_[a-z0-9-]+)*\\.js', 'i');
/******/ 	  var publicPath;
/******/ 	
/******/ 	  if (scripts && scripts.length) {
/******/ 	    for (var i = 0; i < scripts.length; i++) {
/******/ 	      if (!scripts[i]) continue;
/******/ 	      var path = scripts[i].getAttribute('src');
/******/ 	      if (path && path.match(regex)) {
/******/ 	        publicPath = path.substring(0, path.lastIndexOf('/') + 1);
/******/ 	        break;
/******/ 	      }
/******/ 	    }
/******/ 	  }
/******/ 	
/******/ 	  if (!publicPath) {
/******/ 	    for (var global in window.__setWebpackPublicPathLoaderSrcRegistry__) {
/******/ 	      if (global && global.match(regex)) {
/******/ 	        publicPath = global.substring(0, global.lastIndexOf('/') + 1);
/******/ 	        break;
/******/ 	      }
/******/ 	    }
/******/ 	  }
/******/ 	  __webpack_require__.p = publicPath;
/******/ 	})();
/******/ 	
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 2);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_0__;

/***/ }),
/* 1 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_1__;

/***/ }),
/* 2 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });

// EXTERNAL MODULE: external "@microsoft/sp-core-library"
var sp_core_library_ = __webpack_require__(0);
var sp_core_library__default = /*#__PURE__*/__webpack_require__.n(sp_core_library_);

// CONCATENATED MODULE: ./lib/httpClient/FetchProvider.js

var FetchProvider =  (function () {
    function FetchProvider(serviceScope) {
    }
    FetchProvider.prototype.fetch = function (request) {
        return window.fetch(request);
    };
    return FetchProvider;
}());
/* harmony default export */ var httpClient_FetchProvider = (FetchProvider);
var fetchProviderServiceKey = sp_core_library_["ServiceKey"].create('sp-client-base:FetchProvider', FetchProvider);

// CONCATENATED MODULE: ./lib/httpClient/HttpClientConfiguration.js
var HttpClientConfiguration =  (function () {
    function HttpClientConfiguration(flags, overrideFlags) {
        this.flags = {};
        this.initializeFlags();
        this._mergeFlags(flags);
        if (overrideFlags) {
            this._mergeFlags(overrideFlags);
        }
    }
    HttpClientConfiguration.prototype.overrideWith = function (sourceFlags) {
        return new HttpClientConfiguration(this.flags, sourceFlags);
    };
    HttpClientConfiguration.prototype.initializeFlags = function () {
    };
    HttpClientConfiguration.prototype._mergeFlags = function (source) {
        for (var _i = 0, _a = Object.keys(this.flags); _i < _a.length; _i++) {
            var key = _a[_i];
            if (source.hasOwnProperty(key)) {
                if (source[key] !== undefined) {
                    this.flags[key] = source[key];
                }
            }
        }
    };
    return HttpClientConfiguration;
}());
/* harmony default export */ var httpClient_HttpClientConfiguration = (HttpClientConfiguration);
var predefinedConfigurations = {
    v1: new HttpClientConfiguration({})
};

// CONCATENATED MODULE: ./lib/httpClient/HttpClientResponse.js
var HttpClientResponse =  (function () {
    function HttpClientResponse(response) {
        this.nativeResponse = response;
    }
    Object.defineProperty(HttpClientResponse.prototype, "body", {
        get: function () { return this.nativeResponse.body; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpClientResponse.prototype, "bodyUsed", {
        get: function () { return this.nativeResponse.bodyUsed; },
        enumerable: true,
        configurable: true
    });
    HttpClientResponse.prototype.arrayBuffer = function () { return this.nativeResponse.arrayBuffer(); };
    HttpClientResponse.prototype.blob = function () { return this.nativeResponse.blob(); };
    HttpClientResponse.prototype.formData = function () { return this.nativeResponse.formData; }; 
    HttpClientResponse.prototype.json = function () { return this.nativeResponse.json(); };
    HttpClientResponse.prototype.text = function () { return this.nativeResponse.text(); };
    Object.defineProperty(HttpClientResponse.prototype, "type", {
        get: function () { return this.nativeResponse.type; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpClientResponse.prototype, "redirected", {
        get: function () { return this.nativeResponse.redirected; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpClientResponse.prototype, "url", {
        get: function () { return this.nativeResponse.url; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpClientResponse.prototype, "status", {
        get: function () { return this.nativeResponse.status; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpClientResponse.prototype, "ok", {
        get: function () { return this.nativeResponse.ok; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpClientResponse.prototype, "statusText", {
        get: function () { return this.nativeResponse.statusText; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpClientResponse.prototype, "headers", {
        get: function () { return this.nativeResponse.headers; },
        enumerable: true,
        configurable: true
    });
    HttpClientResponse.prototype.clone = function () {
        return new HttpClientResponse(this.nativeResponse.clone());
    };
    return HttpClientResponse;
}());
/* harmony default export */ var httpClient_HttpClientResponse = (HttpClientResponse);

// EXTERNAL MODULE: external "@microsoft/sp-diagnostics"
var sp_diagnostics_ = __webpack_require__(1);
var sp_diagnostics__default = /*#__PURE__*/__webpack_require__.n(sp_diagnostics_);

// CONCATENATED MODULE: ./lib/httpClient/HttpClientHelper.js

var HttpClientHelper_HttpClientHelper =  (function () {
    function HttpClientHelper() {
    }
    HttpClientHelper.overrideHttpMethod = function (options, httpRequestMethod) {
        var modifiedOptions = Object.assign({}, options);
        modifiedOptions.method = httpRequestMethod;
        return modifiedOptions;
    };
    HttpClientHelper.fetchCore = function (configuration, request, serviceScope, fetchProvider, logSource) {
        return new Promise(function (resolve, reject) {
            sp_diagnostics_["_TraceLogger"].logVerbose(sp_diagnostics_["_LogSource"].create(logSource), request.method + " " + request.url);
            return fetchProvider.fetch(request).then(resolve, reject);
        });
    };
    return HttpClientHelper;
}());
/* harmony default export */ var httpClient_HttpClientHelper = (HttpClientHelper_HttpClientHelper);

// CONCATENATED MODULE: ./lib/httpClient/HttpClient.js





var HttpClient_HttpClient =  (function () {
    function HttpClient(serviceScope) {
        var _this = this;
        this._serviceScope = serviceScope;
        serviceScope.whenFinished(function () {
            _this._fetchProvider = serviceScope.consume(fetchProviderServiceKey);
        });
    }
    HttpClient.prototype.fetch = function (url, configuration, options) {
        return httpClient_HttpClientHelper.fetchCore(configuration, new Request(url, options), this._serviceScope, this._fetchProvider, HttpClient._className).then(function (response) {
            return new httpClient_HttpClientResponse(response);
        });
    };
    HttpClient.prototype.get = function (url, configuration, options) {
        return this.fetch(url, configuration, httpClient_HttpClientHelper.overrideHttpMethod(options, 'GET'));
    };
    HttpClient.prototype.post = function (url, configuration, options) {
        return this.fetch(url, configuration, httpClient_HttpClientHelper.overrideHttpMethod(options, 'POST'));
    };
    HttpClient.configurations = predefinedConfigurations;
    HttpClient.serviceKey = sp_core_library_["ServiceKey"].create('sp-http:HttpClient', HttpClient);
    HttpClient._className = 'HttpClient';
    return HttpClient;
}());
/* harmony default export */ var httpClient_HttpClient = (HttpClient_HttpClient);

// CONCATENATED MODULE: ./lib/spHttpClient/DigestCache.js



var DigestCache_DigestCache =  (function () {
    function DigestCache(serviceScope) {
        var _this = this;
        this._digestsByUrl = new Map();
        serviceScope.whenFinished(function () {
            _this._fetchProvider = serviceScope.consume(fetchProviderServiceKey);
            _this._timeProvider = serviceScope.consume(sp_core_library_["TimeProvider"].serviceKey);
        });
    }
    DigestCache.prototype.fetchDigest = function (webUrl) {
        var _this = this;
        var normalizedWebUrl = sp_core_library_["UrlUtilities"].removeEndSlash(webUrl);
        var cachedDigest = this._digestsByUrl.get(normalizedWebUrl);
        if (cachedDigest) {
            var timestamp = this._timeProvider.getTimestamp();
            if (timestamp < cachedDigest.expirationTimestamp) {
                sp_diagnostics_["_TraceLogger"].logVerbose(DigestCache._logSource, 'DigestCache: Reusing cached digest.  Expiration: ' + cachedDigest.expirationTimestamp);
                return Promise.resolve(cachedDigest.value);
            }
        }
        var digestUrl = normalizedWebUrl + '/_api/contextinfo';
        var rawRequest = new Request(digestUrl, {
            method: 'POST',
            headers: {
                'Accept': 'application/json',
                'Content-type': 'application/json;odata=verbose;charset=utf-8'
            },
            credentials: 'same-origin',
            cache: 'no-cache'
        });
        var preFetchDigestTime = this._timeProvider.getTimestamp();
        return this._fetchProvider.fetch(rawRequest).then(function (response) {
            return response.json();
        }).then(function (responseObject) {
            var digestValue = responseObject.FormDigestValue;
            var seconds = responseObject.FormDigestTimeoutSeconds;
            var expirationTimeMs = preFetchDigestTime +
                (1000 * seconds) -
                DigestCache.REST_EXPIRATION_SLOP_MS;
            _this.addDigestToCache(normalizedWebUrl, digestValue, expirationTimeMs);
            sp_diagnostics_["_TraceLogger"].logVerbose(DigestCache._logSource, 'DigestCache: Fetched new digest');
            return digestValue;
        });
    };
    DigestCache.prototype.addDigestToCache = function (webUrl, digestValue, expirationTimestamp) {
        var normalizedWebUrl = sp_core_library_["UrlUtilities"].removeEndSlash(webUrl);
        var newCachedDigest = {
            value: digestValue,
            expirationTimestamp: expirationTimestamp
        };
        this._digestsByUrl.set(normalizedWebUrl, newCachedDigest);
    };
    DigestCache.prototype.clearDigest = function (webUrl) {
        var normalizedWebUrl = sp_core_library_["UrlUtilities"].removeEndSlash(webUrl);
        var found = this._digestsByUrl.delete(normalizedWebUrl);
        sp_diagnostics_["_TraceLogger"].logVerbose(DigestCache._logSource, "DigestCache: Requested to clear cache entry: " + (found ? 'found' : 'not found'));
        return found;
    };
    DigestCache.prototype.clearAllDigests = function () {
        this._digestsByUrl.clear();
    };
    DigestCache.serviceKey = sp_core_library_["ServiceKey"].create('sp-client-base:DigestCache', DigestCache);
    DigestCache.REST_EXPIRATION_SLOP_MS = 15000; 
    DigestCache._logSource = sp_diagnostics_["_LogSource"].create('DigestCache');
    return DigestCache;
}());
/* harmony default export */ var spHttpClient_DigestCache = (DigestCache_DigestCache);

// CONCATENATED MODULE: C:/agent/1/_work/9/s/common/temp/node_modules/.onedrive.pkgs.visualstudio.com/tslib/1.9.3/node_modules/tslib/tslib.es6.js
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
/* global Reflect, Promise */

var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return extendStatics(d, b);
};

function __extends(d, b) {
    extendStatics(d, b);
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}

var __assign = function() {
    __assign = Object.assign || function __assign(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
        }
        return t;
    }
    return __assign.apply(this, arguments);
}

function __rest(s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)
            t[p[i]] = s[p[i]];
    return t;
}

function __decorate(decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
}

function __param(paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
}

function __metadata(metadataKey, metadataValue) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(metadataKey, metadataValue);
}

function __awaiter(thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function __generator(thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
}

function __exportStar(m, exports) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}

function __values(o) {
    var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
    if (m) return m.call(o);
    return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
}

function __read(o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
}

function __spread() {
    for (var ar = [], i = 0; i < arguments.length; i++)
        ar = ar.concat(__read(arguments[i]));
    return ar;
}

function __await(v) {
    return this instanceof __await ? (this.v = v, this) : new __await(v);
}

function __asyncGenerator(thisArg, _arguments, generator) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var g = generator.apply(thisArg, _arguments || []), i, q = [];
    return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;
    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }
    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }
    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }
    function fulfill(value) { resume("next", value); }
    function reject(value) { resume("throw", value); }
    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }
}

function __asyncDelegator(o) {
    var i, p;
    return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;
    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === "return" } : f ? f(v) : v; } : f; }
}

function __asyncValues(o) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var m = o[Symbol.asyncIterator], i;
    return m ? m.call(o) : (o = typeof __values === "function" ? __values(o) : o[Symbol.iterator](), i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i);
    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }
    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }
}

function __makeTemplateObject(cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};

function __importStar(mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result.default = mod;
    return result;
}

function __importDefault(mod) {
    return (mod && mod.__esModule) ? mod : { default: mod };
}

// CONCATENATED MODULE: ./lib/spHttpClient/SPHttpClientCommonConfiguration.js


var SPHttpClientCommonConfiguration_SPHttpClientCommonConfiguration =  (function (_super) {
    __extends(SPHttpClientCommonConfiguration, _super);
    function SPHttpClientCommonConfiguration(flags, overrideFlags) {
        return _super.call(this, flags, overrideFlags) || this;
    }
    SPHttpClientCommonConfiguration.prototype.overrideWith = function (sourceFlags) {
        return new SPHttpClientCommonConfiguration(this.flags, sourceFlags);
    };
    Object.defineProperty(SPHttpClientCommonConfiguration.prototype, "jsonRequest", {
        get: function () {
            return this.flags.jsonRequest;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SPHttpClientCommonConfiguration.prototype, "jsonResponse", {
        get: function () {
            return this.flags.jsonResponse;
        },
        enumerable: true,
        configurable: true
    });
    SPHttpClientCommonConfiguration.prototype.initializeFlags = function () {
        _super.prototype.initializeFlags.call(this);
        this.flags.jsonRequest = false;
        this.flags.jsonResponse = false;
    };
    return SPHttpClientCommonConfiguration;
}(httpClient_HttpClientConfiguration));
/* harmony default export */ var spHttpClient_SPHttpClientCommonConfiguration = (SPHttpClientCommonConfiguration_SPHttpClientCommonConfiguration);

// CONCATENATED MODULE: ./lib/spHttpClient/ODataVersion.js
var ODataVersion =  (function () {
    function ODataVersion(versionString) {
        this._versionString = versionString;
    }
    ODataVersion.tryParseFromHeaders = function (headers) {
        var oDataVersion;
        headers.forEach(function (value, name) {
            if (name.toUpperCase() === 'ODATA-VERSION') {
                oDataVersion = value.trim();
            }
        });
        if (oDataVersion === '3.0') {
            return ODataVersion.v3;
        }
        else if (oDataVersion === '4.0') {
            return ODataVersion.v4;
        }
        else if (oDataVersion) {
            throw new Error('Unsupported OData-Version header: ' + oDataVersion);
        }
        return undefined;
    };
    ODataVersion.prototype.toString = function () {
        return this._versionString;
    };
    ODataVersion.v3 = new ODataVersion('3.0');
    ODataVersion.v4 = new ODataVersion('4.0');
    return ODataVersion;
}());
/* harmony default export */ var spHttpClient_ODataVersion = (ODataVersion);

// CONCATENATED MODULE: ./lib/spHttpClient/SPHttpClientConfiguration.js




var SPHttpClientConfiguration_SPHttpClientConfiguration =  (function (_super) {
    __extends(SPHttpClientConfiguration, _super);
    function SPHttpClientConfiguration(flags, overrideFlags) {
        return _super.call(this, flags, overrideFlags) || this;
    }
    SPHttpClientConfiguration.prototype.overrideWith = function (sourceFlags) {
        return new SPHttpClientConfiguration(this.flags, sourceFlags);
    };
    Object.defineProperty(SPHttpClientConfiguration.prototype, "defaultSameOriginCredentials", {
        get: function () {
            return this.flags.defaultSameOriginCredentials;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SPHttpClientConfiguration.prototype, "defaultODataVersion", {
        get: function () {
            return this.flags.defaultODataVersion;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SPHttpClientConfiguration.prototype, "requestDigest", {
        get: function () {
            return this.flags.requestDigest;
        },
        enumerable: true,
        configurable: true
    });
    SPHttpClientConfiguration.prototype.initializeFlags = function () {
        _super.prototype.initializeFlags.call(this);
        this.flags.defaultSameOriginCredentials = false;
        this.flags.defaultODataVersion = spHttpClient_ODataVersion.v3;
        this.flags.requestDigest = false;
    };
    return SPHttpClientConfiguration;
}(spHttpClient_SPHttpClientCommonConfiguration));
/* harmony default export */ var spHttpClient_SPHttpClientConfiguration = (SPHttpClientConfiguration_SPHttpClientConfiguration);
var SPHttpClientConfiguration_predefinedConfigurations = {
    v1: new SPHttpClientConfiguration_SPHttpClientConfiguration(httpClient_HttpClient.configurations.v1, {
        jsonRequest: true,
        jsonResponse: true,
        defaultSameOriginCredentials: true,
        defaultODataVersion: spHttpClient_ODataVersion.v4,
        requestDigest: true
    })
};

// CONCATENATED MODULE: ./lib/spHttpClient/SPHttpClientResponse.js



var SPHttpClientResponse_SPHttpClientResponse =  (function (_super) {
    __extends(SPHttpClientResponse, _super);
    function SPHttpClientResponse(response) {
        return _super.call(this, response) || this;
    }
    SPHttpClientResponse.prototype.clone = function () {
        return new SPHttpClientResponse(this.nativeResponse.clone());
    };
    Object.defineProperty(SPHttpClientResponse.prototype, "correlationId", {
        get: function () {
            if (!this._correlationId) {
                this._correlationId = sp_core_library_["Guid"].tryParse(this.headers.get("SPRequestGuid" ));
            }
            return this._correlationId;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SPHttpClientResponse.prototype, "statusMessage", {
        get: function () {
            var correlationId = this.headers.get('sprequestguid') || '';
            var spVersion = this.headers.get('microsoftsharepointteamservices') || '';
            return "[HTTP]:" + this.status + " - " + this.statusText + " [CorrelationId]:" + correlationId + " [Version]:" + spVersion;
        },
        enumerable: true,
        configurable: true
    });
    return SPHttpClientResponse;
}(httpClient_HttpClientResponse));
/* harmony default export */ var spHttpClient_SPHttpClientResponse = (SPHttpClientResponse_SPHttpClientResponse);

// CONCATENATED MODULE: ./lib/spHttpClient/BatchedRequest.js
var BatchedRequest =  (function () {
    function BatchedRequest(request) {
        var _this = this;
        this.response = undefined;
        this.request = request;
        this.promise = new Promise(
        function (resolve, reject) {
            _this._resolveCallback = resolve;
            _this._rejectCallback = reject;
        });
    }
    BatchedRequest.prototype.resolvePromise = function (response) {
        if (!this._resolveCallback) {
            throw new Error('The promise was already settled');
        }
        this.response = response;
        this._resolveCallback(response);
        this._resolveCallback = undefined;
        this._rejectCallback = undefined;
    };
    BatchedRequest.prototype.rejectPromiseIfNotResolved = function (error) {
        if (this.response) {
            return;
        }
        if (!this._rejectCallback) {
            throw new Error('The promise was already settled');
        }
        this._rejectCallback(error);
        this._resolveCallback = undefined;
        this._rejectCallback = undefined;
    };
    return BatchedRequest;
}());
/* harmony default export */ var spHttpClient_BatchedRequest = (BatchedRequest);

// CONCATENATED MODULE: ./lib/spHttpClient/SPHttpClientHelper.js



var SPHttpClientHelper_SPHttpClientHelper =  (function (_super) {
    __extends(SPHttpClientHelper, _super);
    function SPHttpClientHelper() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SPHttpClientHelper.cloneHeaders = function (options) {
        var clonedHeaders = new Headers();
        var temp = new Request('', { headers: options.headers || {} });
        temp.headers.forEach(function (value, name) {
            clonedHeaders.append(name, value); 
        });
        return clonedHeaders;
    };
    SPHttpClientHelper.applyDefaultHeaders = function (headers, configuration, options, oDataVersion) {
        if (configuration.jsonRequest) {
            if (options.method && options.method.toUpperCase() !== 'GET') {
                if (!headers.has('Content-Type')) {
                    if (oDataVersion === spHttpClient_ODataVersion.v3) {
                        headers.append('Content-Type', 'application/json;odata=verbose;charset=utf-8');
                    }
                    else if (oDataVersion === spHttpClient_ODataVersion.v4) {
                        headers.append('Content-Type', 'application/json;charset=utf-8');
                    }
                    else {
                        throw new Error('ISPHttpClientConfiguration.jsonRequest is enabled, which requires'
                            + ' the "OData-Version" header to be 3.0 or 4.0');
                    }
                }
            }
        }
        if (configuration.jsonResponse) {
            if (!headers.has('Accept')) {
                if (oDataVersion === spHttpClient_ODataVersion.v3) {
                    headers.append('Accept', 'application/json');
                }
                else if (oDataVersion === spHttpClient_ODataVersion.v4) {
                    headers.append('Accept', 'application/json;odata.metadata=minimal');
                }
                else {
                    throw new Error('ISPHttpClientConfiguration.jsonResponse is enabled, which requires'
                        + ' the "OData-Version" header to be 3.0 or 4.0');
                }
            }
        }
    };
    SPHttpClientHelper.handleAuthenticationErrors = function (promise, webUrl, digestCache) {
        return promise.then(function (response) {
            if (response.status === 403) {
                digestCache.clearDigest(webUrl);
            }
            return response;
        });
    };
    return SPHttpClientHelper;
}(httpClient_HttpClientHelper));
/* harmony default export */ var spHttpClient_SPHttpClientHelper = (SPHttpClientHelper_SPHttpClientHelper);

// CONCATENATED MODULE: ./lib/spHttpClient/SPHttpClientBatchConfiguration.js



var SPHttpClientBatchConfiguration_SPHttpClientBatchConfiguration =  (function (_super) {
    __extends(SPHttpClientBatchConfiguration, _super);
    function SPHttpClientBatchConfiguration(flags, overrideFlags) {
        return _super.call(this, flags, overrideFlags) || this;
    }
    SPHttpClientBatchConfiguration.prototype.overrideWith = function (sourceFlags) {
        return new SPHttpClientBatchConfiguration(this.flags, sourceFlags);
    };
    SPHttpClientBatchConfiguration.prototype.initializeFlags = function () {
        _super.prototype.initializeFlags.call(this);
    };
    return SPHttpClientBatchConfiguration;
}(spHttpClient_SPHttpClientCommonConfiguration));
/* harmony default export */ var spHttpClient_SPHttpClientBatchConfiguration = (SPHttpClientBatchConfiguration_SPHttpClientBatchConfiguration);
var SPHttpClientBatchConfiguration_predefinedConfigurations = {
    v1: new SPHttpClientBatchConfiguration_SPHttpClientBatchConfiguration(httpClient_HttpClient.configurations.v1, {
        jsonRequest: true,
        jsonResponse: true
    })
};

// CONCATENATED MODULE: ./lib/spHttpClient/SPHttpClientBatch.js









var SPHttpClientBatch_SPHttpClientBatch =  (function () {
    function SPHttpClientBatch(serviceScope, batchCreationOptions) {
        var _this = this;
        this._batchedRequests = [];
        serviceScope.whenFinished(function () {
            _this._fetchProvider = serviceScope.consume(fetchProviderServiceKey);
            _this._randomNumberGenerator = serviceScope.consume(sp_core_library_["RandomNumberGenerator"].serviceKey);
            _this._digestCache = serviceScope.consume(spHttpClient_DigestCache.serviceKey);
        });
    }
    SPHttpClientBatch.prototype.fetch = function (url, configuration, options) {
        if (!options) {
            options = {};
        }
        var modifiedOptions = Object.assign({}, options);
        modifiedOptions.headers = spHttpClient_SPHttpClientHelper.cloneHeaders(options);
        spHttpClient_SPHttpClientHelper.applyDefaultHeaders(modifiedOptions.headers, configuration, options, spHttpClient_ODataVersion.v4);
        var request = new Request(url, modifiedOptions);
        var requestUrl = request.url;
        if (!this._webUrl) {
            this._webUrl = spHttpClient_SPHttpClient.getWebUrlFromRequestUrl(requestUrl);
        }
        var batchedRequest = new spHttpClient_BatchedRequest(request);
        this._batchedRequests.push(batchedRequest);
        return batchedRequest.promise;
    };
    SPHttpClientBatch.prototype.get = function (url, configuration, options) {
        var modifiedOptions = Object.assign({}, options);
        modifiedOptions.method = 'GET';
        return this.fetch(url, configuration, modifiedOptions);
    };
    SPHttpClientBatch.prototype.post = function (url, configuration, options) {
        var modifiedOptions = Object.assign({}, options);
        modifiedOptions.method = 'POST';
        return this.fetch(url, configuration, modifiedOptions);
    };
    SPHttpClientBatch.prototype.execute = function () {
        var _this = this;
        var batchBody = '\n';
        var batchGuid = sp_core_library_["Guid"].newGuid(this._randomNumberGenerator);
        var chain = Promise.resolve();
        this._batchedRequests.forEach(function (batchedRequest) {
            chain = chain.then(function () {
                return batchedRequest.request.text();
            }).then(function (requestText) {
                var request = batchedRequest.request;
                batchBody += "--batch_" + batchGuid.toString() + "\n";
                batchBody += "Content-type: application/http\n"
                    + "Content-Transfer-Encoding: binary\n\n";
                batchBody += request.method + " " + request.url + " HTTP/1.1\n";
                request.headers.forEach(function (value, name) {
                    batchBody += name + ": " + value + "\n";
                });
                batchBody += '\n';
                batchBody += requestText;
                batchBody += '\n\n';
            });
        });
        return chain.then(function () {
            batchBody += "--batch_" + batchGuid + "--\n\n";
            return _this._digestCache.fetchDigest(_this._webUrl);
        }).then(function (digest) {
            var headers = new Headers();
            headers.append('Accept', 'application/json');
            headers.append('OData-Version', '4.0');
            headers.append('Content-Type', "multipart/mixed; boundary=batch_" + batchGuid);
            headers.append('Content-Length', batchBody.length.toString());
            headers.append('X-RequestDigest', digest);
            var request = new Request(_this._webUrl + '/_api/$batch', {
                method: 'POST',
                headers: headers,
                body: batchBody,
                credentials: 'same-origin',
                cache: 'no-cache'
            });
            var promise = _this._fetchProvider.fetch(request);
            return spHttpClient_SPHttpClientHelper.handleAuthenticationErrors(promise, _this._webUrl, _this._digestCache);
        }).then(function (response) {
            if (!response.ok) {
                throw new Error('SPHttpClientBatch: The batch request failed: ' + response.statusText);
            }
            return response.text();
        }).then(function (text) {
            var responses = _this._parseResponsesFromBody(text);
            if (responses.length !== _this._batchedRequests.length) {
                throw new Error("SPHttpClientBatch: Expecting " + _this._batchedRequests.length + " responses");
            }
            for (var i = 0; i < _this._batchedRequests.length; ++i) {
                var request = _this._batchedRequests[i];
                request.resolvePromise(new spHttpClient_SPHttpClientResponse(responses[i]));
            }
            return _this;
        }).catch(function (executeError) {
            var fetchError = new TypeError('This request was part of an SPHttpClientBatch that failed');
            for (var _i = 0, _a = _this._batchedRequests; _i < _a.length; _i++) {
                var request = _a[_i];
                request.rejectPromiseIfNotResolved(fetchError);
            }
            return Promise.reject(executeError);
        });
    };
    SPHttpClientBatch.prototype._parseResponsesFromBody = function (text) {
        var responses = [];
        var header = '--batchresponse_';
        var statusRegExp = new RegExp('^HTTP/[0-9.]+ +([0-9]+) +(.*)', 'i');
        var lines = text.split('\n');
        var parserState = 'batch';
        var batchStatus;
        var batchStatusText;
        for (var i = 0; i < lines.length; ++i) {
            var line = lines[i];
            switch (parserState) {
                case 'batch':
                    if (line.substr(0, header.length) === header) {
                        parserState = 'batchHeaders';
                    }
                    else {
                        if (line.trim() !== '') {
                            throw new Error('SPHttpClientBatch: Invalid response, line ' + i);
                        }
                    }
                    break;
                case 'batchHeaders':
                    if (line.trim() === '') {
                        parserState = 'status';
                    }
                    break;
                case 'status':
                    var parts = statusRegExp.exec(line);
                    if (!parts || parts && parts.length !== 3) {
                        throw new Error('SPHttpClientBatch: Invalid status, line ' + i);
                    }
                    batchStatus = parseInt(parts[1], 10);
                    batchStatusText = parts[2];
                    parserState = 'statusHeaders';
                    break;
                case 'statusHeaders':
                    if (line.trim() === '') {
                        parserState = 'body';
                    }
                    break;
                case 'body':
                    var response = new Response(line, { status: batchStatus, statusText: batchStatusText });
                    responses.push(response);
                    parserState = 'batch';
                    break;
            }
        }
        if (parserState !== 'status') {
            throw new Error('SPHttpClientBatch: Unexpected end of input');
        }
        return responses;
    };
    SPHttpClientBatch.configurations = SPHttpClientBatchConfiguration_predefinedConfigurations;
    return SPHttpClientBatch;
}());
/* harmony default export */ var spHttpClient_SPHttpClientBatch = (SPHttpClientBatch_SPHttpClientBatch);

// CONCATENATED MODULE: ./lib/spHttpClient/SPHttpClient.js









var SPHttpClient_SPHttpClient =  (function () {
    function SPHttpClient(serviceScope) {
        var _this = this;
        this._serviceScope = serviceScope;
        this._serviceScope.whenFinished(function () {
            _this._digestCache = serviceScope.consume(spHttpClient_DigestCache.serviceKey);
            _this._parentSource = serviceScope.consume(sp_diagnostics_["_logSourceServiceKey"]);
            _this._fetchProvider = serviceScope.consume(fetchProviderServiceKey);
        });
    }
    SPHttpClient.getWebUrlFromRequestUrl = function (requestUrl) {
        var segmentIndex = -1;
        var upperCaseUrl = requestUrl.toUpperCase();
        for (var _i = 0, _a = SPHttpClient._reservedUrlSegments; _i < _a.length; _i++) {
            var reservedUrlSegment = _a[_i];
            segmentIndex = upperCaseUrl.indexOf(reservedUrlSegment);
            if (segmentIndex >= 0) {
                return requestUrl.substr(0, segmentIndex);
            }
        }
        throw new Error('Unable to determine web URL');
    };
    SPHttpClient.prototype.fetch = function (url, configuration, options) {
        var _this = this;
        if (!options) {
            options = {};
        }
        var modifiedOptions = Object.assign({}, options);
        if (configuration.defaultSameOriginCredentials) {
            if (!options.credentials) {
                modifiedOptions.credentials = 'same-origin';
            }
        }
        var headers = spHttpClient_SPHttpClientHelper.cloneHeaders(options);
        modifiedOptions.headers = headers;
        if (configuration.defaultODataVersion) {
            if (!headers.has('OData-Version')) {
                headers.append('OData-Version', configuration.defaultODataVersion.toString());
            }
        }
        var oDataVersion = spHttpClient_ODataVersion.tryParseFromHeaders(headers);
        spHttpClient_SPHttpClientHelper.applyDefaultHeaders(headers, configuration, options, oDataVersion);
        if (configuration.requestDigest) {
            if (options.method) {
                var method = options.method.toUpperCase();
                if (method !== 'GET' && method !== 'HEAD' && method !== 'OPTIONS') {
                    if (!headers.has('X-RequestDigest')) {
                        var webUrl = options.webUrl || SPHttpClient.getWebUrlFromRequestUrl(url);
                        var promise = this._digestCache.fetchDigest(webUrl)
                            .then(function (digest) {
                            headers.append('X-RequestDigest', digest);
                            return _this._fetchWithInstrumentation(configuration, new Request(url, modifiedOptions));
                        });
                        return spHttpClient_SPHttpClientHelper.handleAuthenticationErrors(promise, webUrl, this._digestCache)
                            .then(function (response) {
                            return new spHttpClient_SPHttpClientResponse(response);
                        });
                    }
                }
            }
        }
        return this._fetchWithInstrumentation(configuration, new Request(url, modifiedOptions))
            .then(function (response) {
            return new spHttpClient_SPHttpClientResponse(response);
        });
    };
    SPHttpClient.prototype.get = function (url, configuration, options) {
        return this.fetch(url, configuration, spHttpClient_SPHttpClientHelper.overrideHttpMethod(options, 'GET'));
    };
    SPHttpClient.prototype.post = function (url, configuration, options) {
        return this.fetch(url, configuration, spHttpClient_SPHttpClientHelper.overrideHttpMethod(options, 'POST'));
    };
    SPHttpClient.prototype.beginBatch = function (batchCreationOptions) {
        return new spHttpClient_SPHttpClientBatch(this._serviceScope, batchCreationOptions);
    };
    SPHttpClient.prototype._fetchWithInstrumentation = function (configuration, request) {
        var _this = this;
        var qosMonitor = new sp_diagnostics_["_QosMonitor"](SPHttpClient._className);
        return spHttpClient_SPHttpClientHelper.fetchCore(configuration, request, this._serviceScope, this._fetchProvider, SPHttpClient._className).then(function (response) {
            if (response.status >= 200 && response.status <= 299) {
                qosMonitor.writeSuccess({ source: _this._logSourceId });
            }
            else if (response.status >= 300 && response.status <= 399) {
                qosMonitor.writeExpectedFailure('Redirection', undefined, { source: _this._logSourceId, responseStatus: response.status });
            }
            else if (response.status >= 400 && response.status <= 499) {
                qosMonitor.writeExpectedFailure('ClientError', undefined, { source: _this._logSourceId, responseStatus: response.status });
            }
            else if (response.status >= 500 && response.status <= 599) {
                qosMonitor.writeExpectedFailure('ServerError', undefined, { source: _this._logSourceId, responseStatus: response.status });
            }
            else {
                qosMonitor.writeUnexpectedFailure('Unknown', undefined, { source: _this._logSourceId, responseStatus: response.status });
            }
            return response;
        }).catch(function (error) {
            qosMonitor.writeUnexpectedFailure('FetchError', error, { source: _this._logSourceId });
            throw error;
        });
    };
    Object.defineProperty(SPHttpClient.prototype, "_logSourceId", {
        get: function () {
            if (this._parentSource.isEmpty()) {
                return SPHttpClient._logSource.id;
            }
            return this._parentSource.id;
        },
        enumerable: true,
        configurable: true
    });
    SPHttpClient.configurations = SPHttpClientConfiguration_predefinedConfigurations;
    SPHttpClient.serviceKey = sp_core_library_["ServiceKey"].create('sp-http:SPHttpClient', SPHttpClient);
    SPHttpClient._className = 'SPHttpClient';
    SPHttpClient._logSource = sp_diagnostics_["_LogSource"].create('spHttpClient');
    SPHttpClient._reservedUrlSegments = [
        '/_API/',
        '/_LAYOUTS/',
        '/_VTI_BIN/'
    ];
    return SPHttpClient;
}());
/* harmony default export */ var spHttpClient_SPHttpClient = (SPHttpClient_SPHttpClient);

// CONCATENATED MODULE: C:/agent/1/_work/9/s/libraries/sp-client-shared/lib/tokenUtility/Constants.js
var Constants =  (function () {
    function Constants() {
    }
    Constants.tokenCacheSessionStorageId = 'tokenCache';
    Constants.aboutToExpireIntervalSeconds = 600;
    Constants.apiUrl = '/_api/SP.OAuth.Token/Acquire';
    Constants.retries = 3;
    Constants.retriableErrorCodes = [
        10006,
        10008
    ];
    Constants.unexpectedErrorCodeFormat = 'Expected error code format is <numericCode>, <exception class name>';
    Constants.unexpectedTokenMessageFormat = 'Your token request succeedeed but the token could not be parsed from the response.' +
        'This is most probably caused by a change in the server response format';
    Constants.npmPackageVersion = '0.1.5';
    return Constants;
}());
/* harmony default export */ var tokenUtility_Constants = (Constants);

// CONCATENATED MODULE: C:/agent/1/_work/9/s/libraries/sp-client-shared/lib/tokenUtility/OAuthUtilityError.js
var OAuthUtilityError___extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var OAuthUtilityErrorType;
(function (OAuthUtilityErrorType) {
    OAuthUtilityErrorType[OAuthUtilityErrorType["unknownError"] = 0] = "unknownError";
    OAuthUtilityErrorType[OAuthUtilityErrorType["malformedResponseBody"] = 1] = "malformedResponseBody";
    OAuthUtilityErrorType[OAuthUtilityErrorType["serverError"] = 2] = "serverError";
})(OAuthUtilityErrorType || (OAuthUtilityErrorType = {}));
var OAuthUtilityError =  (function (_super) {
    OAuthUtilityError___extends(OAuthUtilityError, _super);
    function OAuthUtilityError(type, context) {
        var _this = _super.call(this, context.message) || this;
        _this.__proto__ = OAuthUtilityError.prototype; 
        _this._type = type;
        _this._httpResponseStatus = context.httpResponseStatus;
        _this._cultureName = context.cultureName;
        _this._message = context.message;
        _this._serverErrorCode = context.serverErrorCode;
        _this._correlationId = context.correlationId;
        _this._redirectUrl = context.redirectUrl;
        return _this;
    }
    Object.defineProperty(OAuthUtilityError.prototype, "type", {
        get: function () {
            return this._type;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OAuthUtilityError.prototype, "serverErrorCode", {
        get: function () {
            if (this.type !== OAuthUtilityErrorType.serverError) {
                throw new Error('ServerErrorCode can only be obtained for errors of type serverError');
            }
            return this._serverErrorCode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OAuthUtilityError.prototype, "httpResponseStatus", {
        get: function () {
            return this._httpResponseStatus;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OAuthUtilityError.prototype, "message", {
        get: function () {
            return this._message;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OAuthUtilityError.prototype, "cultureName", {
        get: function () {
            return this._cultureName;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OAuthUtilityError.prototype, "correlationId", {
        get: function () {
            return this._correlationId;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OAuthUtilityError.prototype, "redirectUrl", {
        get: function () {
            return this._redirectUrl;
        },
        enumerable: true,
        configurable: true
    });
    return OAuthUtilityError;
}(Error));
/* harmony default export */ var tokenUtility_OAuthUtilityError = (OAuthUtilityError);

// CONCATENATED MODULE: C:/agent/1/_work/9/s/libraries/sp-client-shared/lib/tokenUtility/OAuthUtility.js


var OAuthUtility_OAuthUtility =  (function () {
    function OAuthUtility(context) {
        var _this = this;
        this._context = context;
        this._dispose = this._dispose.bind(this);
        window.addEventListener('unload', this._dispose);
        var mediaTokenCallback = '_spPageOnMediaTokenReceived';
        window[mediaTokenCallback] = function () {
            _this._receiveMediaServiceFlushedToken();
        };
        var mediaTokenCallbackV2 = '_spMSBTLoaded';
        window[mediaTokenCallbackV2] = function () {
            _this._receiveMediaServiceFlushedToken();
        };
    }
    OAuthUtility._getCorrelationId = function (response) {
        return response.headers.get('sprequestguid');
    };
    OAuthUtility._extractRealError = function (errorResponse) {
        var isNested = errorResponse.hasOwnProperty('error');
        return isNested ? errorResponse.error : errorResponse;
    };
    OAuthUtility.prototype.getOAuthToken = function (resource, webUrl) {
        var _this = this;
        this._receiveMediaServiceFlushedToken();
        var cachedData = this._getCachedTokenData(resource);
        if (cachedData && !this._isExpiring(cachedData)) {
            return Promise.resolve({
                token: cachedData.accessToken,
                isGuest: false,
                expirationTimeMs: cachedData.expiresOn,
                _correlationId: cachedData.correlationId
            });
        }
        return this._retriableFetchWithDigest(resource, tokenUtility_Constants.retries, webUrl)
            .then(function (responseData) {
            _this._storeTokenData(resource, responseData);
            return {
                token: responseData.accessToken,
                isGuest: false,
                expirationTimeMs: responseData.expiresOn,
                _correlationId: responseData.correlationId
            };
        });
    };
    OAuthUtility.prototype.clearCachedToken = function (resource) {
        var key = this._getCacheKey(resource);
        window.sessionStorage.removeItem(key);
        var index = this._resourceKeys.indexOf(key);
        if (!isNaN(index) && index > -1) {
            this._resourceKeys.splice(index);
        }
    };
    Object.defineProperty(OAuthUtility.prototype, "_resourceKeys", {
        get: function () {
            if (!this._keysToDispose) {
                this._keysToDispose = new Array();
            }
            return this._keysToDispose;
        },
        enumerable: true,
        configurable: true
    });
    OAuthUtility.prototype._retriableFetchWithDigest = function (resource, retriesLeft, webUrl) {
        var _this = this;
        var monitor = this._context.qosMonitor();
        return this._context.fetchWithDigest(this._buildTokenRequest(resource, webUrl))
            .then(function (response) {
            if (response.status !== 200) {
                _this._context.logger.logError('fetchWithDigest failed. Server responded with ' + response.statusText);
                var error = new tokenUtility_OAuthUtilityError(OAuthUtilityErrorType.unknownError, {
                    httpResponseStatus: response.status,
                    message: response.statusText,
                    correlationId: OAuthUtility._getCorrelationId(response)
                });
                if (response.status !== 400) {
                    monitor.writeUnexpectedFailure('UnknownError', error);
                    return Promise.reject(error);
                }
                return response.json().then(function (mixedErrorResponse) {
                    var errorResponse = OAuthUtility._extractRealError(mixedErrorResponse);
                    var errorCode = _this._getErrorCodeFromResponseCode(errorResponse);
                    if (!_this._isRetriableError(errorCode) || (retriesLeft === 0)) {
                        var oAuthError = _this._buildErrorFromResponse(errorResponse);
                        monitor.writeUnexpectedFailure('SharepointServerError', oAuthError);
                        return Promise.reject(oAuthError);
                    }
                    _this._context.logger.logError('fetchWithDigest failed. Retrying. Retries left: ' + retriesLeft);
                    return _this._retriableFetchWithDigest(resource, retriesLeft - 1, webUrl);
                });
            }
            return _this._instrumentedParseResponseData(response, monitor);
        });
    };
    OAuthUtility.prototype._getCachedTokenData = function (resource) {
        return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(resource)));
    };
    OAuthUtility.prototype._storeTokenData = function (resource, data) {
        window.sessionStorage.setItem(this._getCacheKey(resource), JSON.stringify(data));
    };
    OAuthUtility.prototype._getCacheKey = function (resource) {
        var key = ['sp-client-shared', tokenUtility_Constants.npmPackageVersion, 'OAuthUtility', resource].join(';');
        var index = this._resourceKeys.indexOf(key);
        if (index === -1) {
            this._resourceKeys.push(key);
        }
        return key;
    };
    OAuthUtility.prototype._isExpiring = function (tokenRequestData) {
        return (tokenRequestData.expiresOn - Date.now() / 1000) < tokenUtility_Constants.aboutToExpireIntervalSeconds;
    };
    OAuthUtility.prototype._isRetriableError = function (errorCode) {
        return tokenUtility_Constants.retriableErrorCodes.indexOf(errorCode) !== -1;
    };
    OAuthUtility.prototype._buildTokenRequest = function (resource, webUrl) {
        var requestHeaders = new Headers();
        requestHeaders.append('Content-Type', 'application/json; charset=utf-8');
        requestHeaders.append('Odata-Version', '4.0');
        requestHeaders.append('Accept', 'application/json;odata.metadata=minimal');
        var request = {
            method: 'POST',
            headers: requestHeaders,
            body: JSON.stringify(this._buildRequestBody(resource))
        };
        var webUrlNoEndingSlash = webUrl;
        if (webUrlNoEndingSlash && webUrlNoEndingSlash.lastIndexOf('/') === webUrlNoEndingSlash.length - 1) {
            webUrlNoEndingSlash = webUrlNoEndingSlash.substr(0, webUrlNoEndingSlash.length - 1);
        }
        return new Request(webUrlNoEndingSlash + tokenUtility_Constants.apiUrl, request);
    };
    OAuthUtility.prototype._buildRequestBody = function (resource) {
        return {
            resource: resource
        };
    };
    OAuthUtility.prototype._buildErrorFromResponse = function (serverErrorResponse) {
        var errorCode = this._getErrorCodeFromResponseCode(serverErrorResponse);
        if (errorCode === undefined) {
            return new tokenUtility_OAuthUtilityError(OAuthUtilityErrorType.malformedResponseBody, {
                httpResponseStatus: 400,
                message: tokenUtility_Constants.unexpectedErrorCodeFormat,
                correlationId: serverErrorResponse.correlationId
            });
        }
        var message;
        var cultureName;
        if (serverErrorResponse.message) {
            if (typeof serverErrorResponse.message === 'string') {
                message = serverErrorResponse.message;
            }
            else {
                message = serverErrorResponse.message.value;
                cultureName = serverErrorResponse.message.lang;
            }
        }
        var redirectUrlKey = 'error.redirectUrl';
        return new tokenUtility_OAuthUtilityError(OAuthUtilityErrorType.serverError, {
            httpResponseStatus: 400,
            message: message,
            cultureName: cultureName,
            serverErrorCode: errorCode,
            correlationId: serverErrorResponse.correlationId,
            redirectUrl: serverErrorResponse[redirectUrlKey] || serverErrorResponse["@" + redirectUrlKey]
        });
    };
    OAuthUtility.prototype._getErrorCodeFromResponseCode = function (serverErrorResponse) {
        var responseErrorCode = serverErrorResponse.code;
        var errorCode = Number(responseErrorCode);
        if (isNaN(errorCode) && typeof serverErrorResponse.message === 'string') {
            var firstCommaIndex = responseErrorCode.indexOf(',');
            if (firstCommaIndex !== -1) {
                errorCode = Number(responseErrorCode.substr(0, firstCommaIndex));
            }
        }
        return errorCode;
    };
    OAuthUtility.prototype._instrumentedParseResponseData = function (response, monitor) {
        try {
            return response.json().then(function (responseBody) {
                monitor.writeSuccess();
                return {
                    accessToken: responseBody.access_token,
                    correlationId: OAuthUtility._getCorrelationId(response),
                    expiresOn: Number(responseBody.expires_on),
                    notBefore: Number(responseBody.not_before),
                    resource: responseBody.resource,
                    tokenType: responseBody.token_type
                };
            });
        }
        catch (error) {
            monitor.writeUnexpectedFailure('ResponseParseError', error);
            return Promise.reject(new tokenUtility_OAuthUtilityError(OAuthUtilityErrorType.malformedResponseBody, {
                httpResponseStatus: 200,
                message: tokenUtility_Constants.unexpectedTokenMessageFormat,
                correlationId: OAuthUtility._getCorrelationId(response)
            }));
        }
    };
    OAuthUtility.prototype._dispose = function (ev) {
        window.removeEventListener('unload', this._dispose);
        for (var _i = 0, _a = this._resourceKeys; _i < _a.length; _i++) {
            var key = _a[_i];
            window.sessionStorage.removeItem(key);
        }
    };
    OAuthUtility.prototype._receiveMediaServiceFlushedToken = function () {
        var tokenKey = '_spMSBT';
        if (window[tokenKey]) {
            var responseData = {
                tokenType: window[tokenKey].TokenType,
                expiresOn: window[tokenKey].ExpiresOn,
                notBefore: undefined,
                resource: window[tokenKey].Resource,
                accessToken: window[tokenKey].AccessToken
            };
            this._storeTokenData(responseData.resource, responseData);
            window[tokenKey] = undefined;
        }
    };
    return OAuthUtility;
}());
/* harmony default export */ var tokenUtility_OAuthUtility = (OAuthUtility_OAuthUtility);

// CONCATENATED MODULE: C:/agent/1/_work/9/s/libraries/sp-client-shared/lib/index.js



// CONCATENATED MODULE: ./lib/oauthTokenProvider/OAuthUtilityContext.js


var OAuthUtilityContext_TokenUtilityLogger =  (function () {
    function TokenUtilityLogger() {
    }
    TokenUtilityLogger.prototype.logInfo = function (message) {
        sp_diagnostics_["_TraceLogger"].logVerbose(TokenUtilityLogger.logSource, message);
    };
    TokenUtilityLogger.prototype.logError = function (message) {
        sp_diagnostics_["_TraceLogger"].logError(TokenUtilityLogger.logSource, new Error(message));
    };
    TokenUtilityLogger.prototype.logWarning = function (message) {
        sp_diagnostics_["_TraceLogger"].logVerbose(TokenUtilityLogger.logSource, 'Warning: ' + message);
    };
    TokenUtilityLogger.logSource = sp_diagnostics_["_LogSource"].create('TokenUtility');
    return TokenUtilityLogger;
}());
var OAuthUtilityContext_OAuthUtilityContext =  (function () {
    function OAuthUtilityContext(serviceScope) {
        var _this = this;
        serviceScope.whenFinished(function () {
            _this._spHttpClient = serviceScope.consume(spHttpClient_SPHttpClient.serviceKey);
            _this._logger = new OAuthUtilityContext_TokenUtilityLogger();
        });
    }
    Object.defineProperty(OAuthUtilityContext.prototype, "logger", {
        get: function () {
            return this._logger;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OAuthUtilityContext.prototype, "webUrl", {
        get: function () {
            return '';
        },
        enumerable: true,
        configurable: true
    });
    OAuthUtilityContext.prototype.fetchWithDigest = function (request) {
        var _this = this;
        return request.blob().then(function (requestBody) {
            return _this._spHttpClient.fetch(request.url, spHttpClient_SPHttpClient.configurations.v1, {
                method: request.method,
                headers: request.headers,
                body: requestBody
            });
        });
    };
    OAuthUtilityContext.prototype.qosMonitor = function () {
        return new sp_diagnostics_["_QosMonitor"](OAuthUtilityContext.qosName);
    };
    OAuthUtilityContext.qosName = 'OAuthTokenProvider';
    return OAuthUtilityContext;
}());
/* harmony default export */ var oauthTokenProvider_OAuthUtilityContext = (OAuthUtilityContext_OAuthUtilityContext);

// CONCATENATED MODULE: ./lib/oauthTokenProvider/OAuthTokenProvider.js



var OAuthTokenProvider_OAuthTokenProvider =  (function () {
    function OAuthTokenProvider(serviceScope) {
        this._tokenUtility = new tokenUtility_OAuthUtility(new oauthTokenProvider_OAuthUtilityContext(serviceScope));
    }
    OAuthTokenProvider.prototype.getOAuthToken = function (resource, webUrl) {
        sp_core_library_["Validate"].isNotNullOrUndefined(resource, 'resource');
        sp_core_library_["Validate"].isNonemptyString(resource, 'resource');
        return this._tokenUtility.getOAuthToken(resource, webUrl);
    };
    OAuthTokenProvider.prototype.clearCachedToken = function (resource) {
        sp_core_library_["Validate"].isNotNullOrUndefined(resource, 'resource');
        sp_core_library_["Validate"].isNonemptyString(resource, 'resource');
        this._tokenUtility.clearCachedToken(resource);
    };
    OAuthTokenProvider.serviceKey = sp_core_library_["ServiceKey"].create('sp-client-shared:OAuthTokenProvider', OAuthTokenProvider);
    return OAuthTokenProvider;
}());
/* harmony default export */ var oauthTokenProvider_OAuthTokenProvider = (OAuthTokenProvider_OAuthTokenProvider);

// CONCATENATED MODULE: ./lib/SPHttpStrings.resx.js
var SPHttpStrings_resx_key = '_+tvmKa3YEOqWGKKXzwjtaw';
var allStrings = ( false) ?
    require("./resx-strings/en-us.json") :
    __webpack_require__(3);
var strings = allStrings[SPHttpStrings_resx_key];
/* harmony default export */ var SPHttpStrings_resx = (strings);

// CONCATENATED MODULE: ./lib/oauthTokenProvider/MockAadTokenProvider.js


var MockAadTokenProvider_MockAadTokenProvider =  (function () {
    function MockAadTokenProvider() {
        this._tokenAcquisitionEvent = new sp_core_library_["SPEvent"](MockAadTokenProvider._tokenAcquisitionEventId);
    }
    MockAadTokenProvider.prototype.getToken = function (resourceEndpoint, configuration) {
        return Promise.reject(new Error(SPHttpStrings_resx.servicePrincipalNotAvaliableError));
    };
    Object.defineProperty(MockAadTokenProvider.prototype, "tokenAcquisitionEvent", {
        get: function () {
            return this._tokenAcquisitionEvent;
        },
        enumerable: true,
        configurable: true
    });
    MockAadTokenProvider._tokenAcquisitionEventId = 'tokenAcquisitionFailure';
    return MockAadTokenProvider;
}());
/* harmony default export */ var oauthTokenProvider_MockAadTokenProvider = (MockAadTokenProvider_MockAadTokenProvider);

// CONCATENATED MODULE: ./lib/oauthTokenProvider/AadTokenProviders.js

var AadTokenProviders_AadTokenProviders =  (function () {
    function AadTokenProviders() {
    }
    AadTokenProviders._initialize = function (configurable, preAuthorizedConfig) {
        AadTokenProviders._configurableTokenProvider = configurable;
        AadTokenProviders._preAuthorizedConfiguration = preAuthorizedConfig;
    };
    Object.defineProperty(AadTokenProviders, "configurable", {
        get: function () {
            return AadTokenProviders._configurableTokenProvider;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AadTokenProviders, "preAuthorizedConfiguration", {
        get: function () {
            return this._preAuthorizedConfiguration;
        },
        enumerable: true,
        configurable: true
    });
    AadTokenProviders._configurableTokenProvider = new oauthTokenProvider_MockAadTokenProvider();
    return AadTokenProviders;
}());
/* harmony default export */ var oauthTokenProvider_AadTokenProviders = (AadTokenProviders_AadTokenProviders);

// CONCATENATED MODULE: ./lib/oauthTokenProvider/AadConstants.js
var AadConstants =  (function () {
    function AadConstants() {
    }
    AadConstants.SPFX_SINGLE_SIGN_ON_REPLY_URL = 'spfxsinglesignon.aspx';
    AadConstants.REDIRECT_QUERY_PARAM = 'redirect';
    AadConstants.PRE_AUTHORIZED_APP_PRINCIPAL_ID = '08e18876-6177-487e-b8b5-cf950c1e598c';
    AadConstants.APP_DID_NOT_CONSENT_ERROR_CODE = 'AADSTS65001';
    AadConstants.UNMANAGED_DEVICE_ERROR_CODE = 'AADSTS53000';
    AadConstants.RESOLVABLE_ERROR_CODES = new Set([
        'AADSTS50076',
        'AADSTS50079',
        'AADSTS50132',
        'AADSTS50133' 
    ]);
    return AadConstants;
}());
/* harmony default export */ var oauthTokenProvider_AadConstants = (AadConstants);

// CONCATENATED MODULE: ./lib/graphHttpClient/GraphHttpClientResponse.js



var GraphHttpClientResponse_GraphHttpClientResponse =  (function (_super) {
    __extends(GraphHttpClientResponse, _super);
    function GraphHttpClientResponse(response) {
        return _super.call(this, response) || this;
    }
    GraphHttpClientResponse.prototype.clone = function () {
        return new GraphHttpClientResponse(this.nativeResponse.clone());
    };
    Object.defineProperty(GraphHttpClientResponse.prototype, "correlationId", {
        get: function () {
            if (!this._correlationId) {
                this._correlationId = sp_core_library_["Guid"].tryParse(this.headers.get('request-id'));
            }
            return this._correlationId;
        },
        enumerable: true,
        configurable: true
    });
    return GraphHttpClientResponse;
}(httpClient_HttpClientResponse));
/* harmony default export */ var graphHttpClient_GraphHttpClientResponse = (GraphHttpClientResponse_GraphHttpClientResponse);

// CONCATENATED MODULE: ./lib/graphHttpClient/GraphHttpClientConfiguration.js



var GraphHttpClientConfiguration_GraphHttpClientConfiguration =  (function (_super) {
    __extends(GraphHttpClientConfiguration, _super);
    function GraphHttpClientConfiguration(flags, overrideFlags) {
        return _super.call(this, flags, overrideFlags) || this;
    }
    return GraphHttpClientConfiguration;
}(httpClient_HttpClientConfiguration));
/* harmony default export */ var graphHttpClient_GraphHttpClientConfiguration = (GraphHttpClientConfiguration_GraphHttpClientConfiguration);
var GraphHttpClientConfiguration_predefinedConfigurations = {
    v1: new GraphHttpClientConfiguration_GraphHttpClientConfiguration(httpClient_HttpClient.configurations.v1)
};

// CONCATENATED MODULE: ./lib/graphHttpClient/GraphHttpClientContext.js

var GraphHttpClientContext_GraphHttpClientContext =  (function () {
    function GraphHttpClientContext(serviceScope) {
    }
    GraphHttpClientContext.prototype.initialize = function (webServerRelativeUrl, graphEndpointUrl) {
        if (this._isInitialized) {
            throw new Error('GraphHttpClientContext has already been initialized.');
        }
        this._isInitialized = true;
        this._webServerRelativeUrl = webServerRelativeUrl;
        this._graphEndpointUrl = graphEndpointUrl;
    };
    GraphHttpClientContext.prototype.getGraphEndpointUrl = function () {
        if (!this._isInitialized) {
            throw new Error('This operation cannot be performed until the GraphHttpClientContext is initialized.');
        }
        return this._graphEndpointUrl;
    };
    GraphHttpClientContext.prototype.getWebServerRelativeUrl = function () {
        if (!this._isInitialized) {
            throw new Error('This operation cannot be performed until the GraphHttpClientContext is initialized.');
        }
        return this._webServerRelativeUrl;
    };
    GraphHttpClientContext.serviceKey = sp_core_library_["ServiceKey"].create('sp-http:GraphHttpClientContext', GraphHttpClientContext);
    return GraphHttpClientContext;
}());
/* harmony default export */ var graphHttpClient_GraphHttpClientContext = (GraphHttpClientContext_GraphHttpClientContext);

// CONCATENATED MODULE: ./lib/graphHttpClient/GraphHttpClient.js









var GraphHttpClient_GraphHttpClient =  (function () {
    function GraphHttpClient(serviceScope) {
        var _this = this;
        this._serviceScope = serviceScope;
        this._serviceScope.whenFinished(function () {
            _this._tokenProvider = serviceScope.consume(oauthTokenProvider_OAuthTokenProvider.serviceKey);
            _this._parentSource = serviceScope.consume(sp_diagnostics_["_logSourceServiceKey"]);
            _this._graphContext = serviceScope.consume(graphHttpClient_GraphHttpClientContext.serviceKey);
            _this._fetchProvider = serviceScope.consume(fetchProviderServiceKey);
        });
    }
    GraphHttpClient.prototype.fetch = function (url, configuration, options) {
        var _this = this;
        this._validateGraphRelativeUrl(url);
        return this._getOAuthToken().then(function () {
            if (!options) {
                options = {};
            }
            var modifiedOptions = Object.assign({}, options);
            var defaultHeaders = new Headers();
            defaultHeaders.append('Accept', 'application/json');
            defaultHeaders.append('Authorization', 'Bearer ' + _this._token);
            defaultHeaders.append('Content-Type', 'application/json; charset=utf-8');
            var userHeaders = spHttpClient_SPHttpClientHelper.cloneHeaders(options);
            modifiedOptions.headers = _this._mergeUserHeaders(defaultHeaders, userHeaders);
            return _this._fetchWithInstrumentation(configuration, new Request(_this._graphContext.getGraphEndpointUrl() + '/' + url, modifiedOptions)).then(function (response) {
                return new graphHttpClient_GraphHttpClientResponse(response);
            });
        });
    };
    GraphHttpClient.prototype.get = function (url, configuration, options) {
        return this.fetch(url, configuration, httpClient_HttpClientHelper.overrideHttpMethod(options, 'GET'));
    };
    GraphHttpClient.prototype.post = function (url, configuration, options) {
        return this.fetch(url, configuration, httpClient_HttpClientHelper.overrideHttpMethod(options, 'POST'));
    };
    GraphHttpClient.prototype._fetchWithInstrumentation = function (configuration, request) {
        var _this = this;
        var qosMonitor = new sp_diagnostics_["_QosMonitor"]('GraphHttpClient.Fetch');
        return httpClient_HttpClientHelper.fetchCore(configuration, request, this._serviceScope, this._fetchProvider, GraphHttpClient._className).then(function (response) {
            _this._writeQosMonitorUpdate(response, qosMonitor, 'Fetch');
            return response;
        }).catch(function (error) {
            qosMonitor.writeUnexpectedFailure('Fetch', error, { source: _this._logSourceId });
            return Promise.reject(error);
        });
    };
    GraphHttpClient.prototype._getOAuthToken = function () {
        var _this = this;
        var qosMonitor = new sp_diagnostics_["_QosMonitor"]('GraphHttpClient.FetchGraphToken');
        return this._tokenProvider.getOAuthToken(this._graphContext.getGraphEndpointUrl(), this._graphContext.getWebServerRelativeUrl()).then(function (response) {
            _this._writeQosMonitorUpdate(response, qosMonitor, 'FetchGraphToken');
            _this._token = response.token;
        })
            .catch(function (error) {
            qosMonitor.writeUnexpectedFailure('FetchGraphToken', error, { source: _this._logSourceId });
            return Promise.reject(error);
        });
    };
    Object.defineProperty(GraphHttpClient.prototype, "_logSourceId", {
        get: function () {
            if (this._parentSource.isEmpty()) {
                return GraphHttpClient._logSource.id;
            }
            return this._parentSource.id;
        },
        enumerable: true,
        configurable: true
    });
    GraphHttpClient.prototype._mergeUserHeaders = function (defaultHeaders, userHeaders) {
        userHeaders.forEach(function (value, name) {
            defaultHeaders.set(name, value); 
        });
        return defaultHeaders;
    };
    GraphHttpClient.prototype._writeQosMonitorUpdate = function (response, qosMonitor, operation) {
        if (response.status >= 200 && response.status <= 299) {
            qosMonitor.writeSuccess({ source: this._logSourceId });
        }
        else if (response.status >= 300 && response.status <= 499) {
            qosMonitor.writeExpectedFailure(operation, undefined, { source: this._logSourceId, responseStatus: response.status });
        }
        else {
            qosMonitor.writeUnexpectedFailure(operation, undefined, { source: this._logSourceId, responseStatus: response.status });
        }
    };
    GraphHttpClient.prototype._validateGraphRelativeUrl = function (url) {
        sp_core_library_["Validate"].isNotNullOrUndefined(url, 'url');
        if (url.charAt(0) === '/') {
            throw new Error('GraphHttpClient requests cannot begin with a / character');
        }
        if (url.indexOf('http://', 0) === 0) {
            throw new Error('GraphHttpClient requests cannot specify a different graph server with the url.');
        }
        if (url.indexOf('https://', 0) === 0) {
            throw new Error('GraphHttpClient requests cannot specify a different graph server with the url.');
        }
    };
    GraphHttpClient.configurations = GraphHttpClientConfiguration_predefinedConfigurations;
    GraphHttpClient.serviceKey = sp_core_library_["ServiceKey"].create('sp-http:GraphHttpClient', GraphHttpClient);
    GraphHttpClient._className = 'GraphHttpClient';
    GraphHttpClient._logSource = sp_diagnostics_["_LogSource"].create('graphHttpClient');
    return GraphHttpClient;
}());
/* harmony default export */ var graphHttpClient_GraphHttpClient = (GraphHttpClient_GraphHttpClient);

// CONCATENATED MODULE: ./lib/oauthTokenProvider/AdalAuthContext.js





var AdalAuthContext_AdalAuthContext =  (function () {
    function AdalAuthContext(authContext, aadUserId) {
        this.servicePrincipalId = authContext.config.clientId;
        this._aadUserId = aadUserId || '';
        this._patchAdalAuthContext(authContext);
        this._authContext = authContext;
    }
    AdalAuthContext._handleInteractionRequiredFailures = function (authContext, errorMessage, resource, isFetchingAccessToken) {
        if (AdalAuthContext._isInteractionRequiredTokenRetrievalError(errorMessage)) {
            var urlNavigate = isFetchingAccessToken ?
                authContext._getNavigateUrl(authContext.RESPONSE_TYPE.TOKEN, resource) :
                authContext._getNavigateUrl(authContext.CONSTANTS.ID_TOKEN, undefined);
            urlNavigate += '&prompt=select_account';
            sp_core_library_["_SPEventManager"].instance.raiseEvent(oauthTokenProvider_AadTokenProvider._tokenAcquisitionEventId, new AadTokenProvider_TokenAcquisitionEventArgs(SPHttpStrings_resx.additionalCredentialsWarning, urlNavigate));
            return true;
        }
        return false;
    };
    AdalAuthContext._isExpectedIdTokenFetchFailure = function (authContext, message) {
        if (AdalAuthContext._handleInteractionRequiredFailures(authContext, message, undefined, false) ||
            message.indexOf(oauthTokenProvider_AadConstants.UNMANAGED_DEVICE_ERROR_CODE) < 0) {
            return true;
        }
        return false;
    };
    AdalAuthContext._isInteractionRequiredTokenRetrievalError = function (errorMessage) {
        var errorCodes = errorMessage.match(/(AADSTS)\w+/g) || [];
        for (var _i = 0, errorCodes_1 = errorCodes; _i < errorCodes_1.length; _i++) {
            var errorCode = errorCodes_1[_i];
            if (oauthTokenProvider_AadConstants.RESOLVABLE_ERROR_CODES.has(errorCode)) {
                return true;
            }
        }
        return false;
    };
    AdalAuthContext.prototype.getToken = function (resourceEndpoint) {
        var _this = this;
        return this._getIdToken()
            .then(function () { return _this._getAccessToken(resourceEndpoint); });
    };
    AdalAuthContext.prototype._getIdToken = function () {
        if (this._tryGetCachedIdToken()) {
            return Promise.resolve();
        }
        else {
            return this._fetchIdToken();
        }
    };
    AdalAuthContext.prototype._getAccessToken = function (resourceEndpoint) {
        var cachedAccessToken = this._tryGetCachedAccessToken(resourceEndpoint);
        if (cachedAccessToken) {
            return Promise.resolve(cachedAccessToken);
        }
        else {
            return this._fetchAccessToken(resourceEndpoint);
        }
    };
    AdalAuthContext.prototype._tryGetCachedIdToken = function () {
        var validCachedToken;
        try {
            var cachedToken = this._authContext.getCachedToken(this.servicePrincipalId);
            if (cachedToken && this._aadUserId) {
                var user = this._authContext._createUser(cachedToken);
                if (user &&
                    user.profile &&
                    user.profile.oid === this._aadUserId &&
                    user.profile.aud === this._authContext.config.clientId) {
                    this._authContext._user = user;
                    validCachedToken = cachedToken;
                }
            }
        }
        catch (e) {
        }
        return validCachedToken;
    };
    AdalAuthContext.prototype._fetchIdToken = function () {
        var _this = this;
        var acquireIdTokenMonitor = new sp_diagnostics_["_QosMonitor"]('AadTokenProvider.AcquireIdTokenSilent');
        var acquireIdTokenFirstAttemptMonitor = new sp_diagnostics_["_QosMonitor"]('AadTokenProvider.AcquireIdTokenFirstAttempt');
        var didFirstAttemptSucceed = false;
        return this._fetchIdTokenSilent(this.servicePrincipalId, this._authContext.config.redirectUri)
            .then(function (token) {
            didFirstAttemptSucceed = true;
            _this._authContext._user = _this._authContext._createUser(token);
            acquireIdTokenFirstAttemptMonitor.writeSuccess();
        })
            .catch(function (e) {
            if (AdalAuthContext._isExpectedIdTokenFetchFailure(_this._authContext, e.message)) {
                acquireIdTokenFirstAttemptMonitor.writeExpectedFailure(e.message);
                return Promise.reject(e);
            }
            else {
                acquireIdTokenFirstAttemptMonitor.writeUnexpectedFailure(e.message);
                return _this._fetchIdTokenSilent(_this.servicePrincipalId, _this._authContext.config.redirectUri);
            }
        })
            .then(function (token) {
            if (!didFirstAttemptSucceed) {
                _this._authContext._user = _this._authContext._createUser(token);
            }
            acquireIdTokenMonitor.writeSuccess();
        })
            .catch(function (e) {
            if (AdalAuthContext._isExpectedIdTokenFetchFailure(_this._authContext, e.message)) {
                acquireIdTokenMonitor.writeExpectedFailure(e.message);
            }
            else {
                acquireIdTokenMonitor.writeUnexpectedFailure(e.message);
            }
            throw e;
        });
    };
    AdalAuthContext.prototype._fetchIdTokenSilent = function (servicePrincipalId, redirectUri) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            _this._authContext._renewIdToken(function (message, token) {
                if (!token) {
                    reject(new Error(message));
                }
                else {
                    resolve(token);
                }
            });
        });
    };
    AdalAuthContext.prototype._tryGetCachedAccessToken = function (resourceEndpoint) {
        var cachedToken;
        try {
            cachedToken = this._authContext.getCachedToken(resourceEndpoint);
        }
        catch (e) {
        }
        return cachedToken;
    };
    AdalAuthContext.prototype._fetchAccessToken = function (resourceEndpoint) {
        var _this = this;
        var acquireAccessTokenQosMonitor = new sp_diagnostics_["_QosMonitor"]('AadTokenProvider.AcquireAccessToken');
        return this._fetchAccessTokenSilent(resourceEndpoint)
            .then(function (token) {
            acquireAccessTokenQosMonitor.writeSuccess();
            return token;
        })
            .catch(function (e) {
            if (AdalAuthContext._handleInteractionRequiredFailures(_this._authContext, e.message, resourceEndpoint, true)) {
                acquireAccessTokenQosMonitor.writeExpectedFailure(e.message);
            }
            else if (e.message.indexOf(oauthTokenProvider_AadConstants.APP_DID_NOT_CONSENT_ERROR_CODE) < 0 ||
                e.message.indexOf(oauthTokenProvider_AadConstants.UNMANAGED_DEVICE_ERROR_CODE) < 0) {
                acquireAccessTokenQosMonitor.writeExpectedFailure(e.message);
            }
            else {
                acquireAccessTokenQosMonitor.writeUnexpectedFailure(e.message);
            }
            throw e;
        });
    };
    AdalAuthContext.prototype._fetchAccessTokenSilent = function (resourceEndpoint) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            _this._authContext.acquireToken(resourceEndpoint, function (message, token) {
                if (!token) {
                    reject(new Error(message));
                }
                else {
                    resolve(token);
                }
            });
        });
    };
    AdalAuthContext.prototype._patchAdalAuthContext = function (authContext) {
        var _this = this;
        Object.getPrototypeOf(authContext)._singletonInstance = undefined;
        authContext._addAdalFrame = function (iframeId) {
            return _this._addAdalFrame(authContext, iframeId);
        };
    };
    AdalAuthContext.prototype._addAdalFrame = function (authContext, iframeId) {
        if (typeof iframeId === 'undefined') {
            return;
        }
        authContext.info('Add adal frame to document:' + iframeId);
        var adalFrame = document.getElementById(iframeId);
        var sandboxAttributes = 'allow-same-origin allow-scripts allow-forms allow-pointer-lock';
        if (!adalFrame) {
            if (document.createElement && document.documentElement &&
                (window.opera || window.navigator.userAgent.indexOf('MSIE 5.0') === -1)) {
                var ifr = document.createElement('iframe');
                ifr.setAttribute('id', iframeId);
                ifr.setAttribute('aria-hidden', 'true');
                ifr.setAttribute('sandbox', sandboxAttributes);
                ifr.style.visibility = 'hidden';
                ifr.style.position = 'absolute';
                ifr.style.width = ifr.style.height = ifr.style.border = '0';
                adalFrame = document.getElementsByTagName('body')[0].appendChild(ifr);
            }
            else if (document.body && document.body.insertAdjacentHTML) {
                document.body.insertAdjacentHTML('beforeEnd', '<iframe sandbox="' + sandboxAttributes + '" name="' +
                    iframeId + '" id="' + iframeId + '" style="display:none"></iframe>');
            }
            if (window.frames && window.frames[iframeId]) {
                adalFrame = window.frames[iframeId];
            }
        }
        return adalFrame;
    };
    return AdalAuthContext;
}());
/* harmony default export */ var oauthTokenProvider_AdalAuthContext = (AdalAuthContext_AdalAuthContext);

// CONCATENATED MODULE: ./lib/oauthTokenProvider/OBOTokenProvider.js



var OBOTokenProvider_OBOTokenProvider =  (function () {
    function OBOTokenProvider(authContext, tokenParameters) {
        this.servicePrincipalId = authContext.config.clientId;
        this._patchAdalAuthContext(authContext);
        this._authContext = authContext;
        this._serverRelativeUrl = tokenParameters.serverRelativeUrl;
        this._spHttpClient = tokenParameters.spHttpClient;
    }
    OBOTokenProvider.prototype.getToken = function (resourceEndpoint) {
        return this._getAccessToken(resourceEndpoint);
    };
    OBOTokenProvider.prototype._getAccessToken = function (resourceEndpoint) {
        var cachedAccessToken = this._tryGetCachedAccessToken(resourceEndpoint);
        if (cachedAccessToken) {
            return Promise.resolve(cachedAccessToken);
        }
        else {
            return this._fetchAccessToken(resourceEndpoint);
        }
    };
    OBOTokenProvider.prototype._tryGetCachedAccessToken = function (resourceEndpoint) {
        var cachedToken;
        try {
            cachedToken = this._authContext.getCachedToken(resourceEndpoint);
        }
        catch (e) {
            sp_diagnostics_["_TraceLogger"].logError(OBOTokenProvider._logSource, e);
        }
        return cachedToken;
    };
    OBOTokenProvider.prototype._fetchAccessToken = function (resourceEndpoint) {
        var acquireAccessTokenQosMonitor = new sp_diagnostics_["_QosMonitor"]('OBOTokenProvider.AcquireAccessToken');
        return this._fetchAccessTokenSilent(resourceEndpoint)
            .then(function (token) {
            acquireAccessTokenQosMonitor.writeSuccess();
            return token;
        })
            .catch(function (e) {
            if (e.message.indexOf(oauthTokenProvider_AadConstants.APP_DID_NOT_CONSENT_ERROR_CODE) < 0 ||
                e.message.indexOf(oauthTokenProvider_AadConstants.UNMANAGED_DEVICE_ERROR_CODE) < 0) {
                acquireAccessTokenQosMonitor.writeExpectedFailure(e.message);
            }
            else {
                acquireAccessTokenQosMonitor.writeUnexpectedFailure(e.message);
            }
            throw e;
        });
    };
    OBOTokenProvider.prototype._fetchAccessTokenSilent = function (resourceEndpoint) {
        var successfulResponse = false;
        var urlToCall = this._serverRelativeUrl + "/_api/Microsoft.SharePoint.Internal" +
            (".ClientSideComponent.Token.AcquireOBOToken?resource='" + resourceEndpoint + "'") +
            ("&clientId='" + this._authContext.config.clientId + "'");
        return this._spHttpClient.get(urlToCall, spHttpClient_SPHttpClient.configurations.v1, {
            headers: {
                'X-HTTP-Method': 'GET',
                'OData-Version': '3.0'
            }
        })
            .then(function (response) {
            if (response.ok) {
                successfulResponse = true;
            }
            return response.json();
        })
            .then(function (json) {
            if (!successfulResponse) {
                throw new Error(json);
            }
            return json.AccessToken;
        });
    };
    OBOTokenProvider.prototype._patchAdalAuthContext = function (authContext) {
        Object.getPrototypeOf(authContext)._singletonInstance = undefined;
    };
    OBOTokenProvider._logSource = sp_diagnostics_["_LogSource"].create('OBOTokenProvider');
    return OBOTokenProvider;
}());


// CONCATENATED MODULE: ./lib/oauthTokenProvider/AdalAuthContextManager.js



var AdalAuthContextManager_AdalAuthContextManager =  (function () {
    function AdalAuthContextManager() {
        this._loadAdalJsModulePromise = undefined;
        this._authContextDictionary = new Map();
    }
    AdalAuthContextManager.convertTokenParametersToConfig = function (tokenProviderParameters) {
        var extraQueryParameter;
        if (tokenProviderParameters.userEmail &&
            !sp_core_library_["_SPKillSwitch"].isActivated(AdalAuthContextManager.usePromptQueryParamKillSwitchGuid, '12/02/18', 'Use login hint to resolve ambiguous users failure')) {
            extraQueryParameter = "login_hint=" + encodeURIComponent(tokenProviderParameters.userEmail);
        }
        return {
            clientId: tokenProviderParameters.servicePrincipalId,
            redirectUri: tokenProviderParameters.redirectUri,
            instance: sp_core_library_["UrlUtilities"].removeEndSlash(tokenProviderParameters.aadInstanceUrl) + '/',
            loadFrameTimeout: 10000,
            tenant: tokenProviderParameters.aadTenantId,
            navigateToLoginRequestUrl: false,
            extraQueryParameter: extraQueryParameter
        };
    };
    AdalAuthContextManager.prototype.getAuthContext = function (tokenProviderConfiguration, sharePointOBOProviderConfiguration) {
        var _this = this;
        if (!this._loadAdalJsModulePromise) {
            this._loadAdalJsModulePromise = this._loadAdalJs();
        }
        return this._loadAdalJsModulePromise.then(function (adalModule) {
            if (sharePointOBOProviderConfiguration) {
                return new OBOTokenProvider_OBOTokenProvider(adalModule.inject(AdalAuthContextManager.convertTokenParametersToConfig(tokenProviderConfiguration)), sharePointOBOProviderConfiguration);
            }
            if (!_this._authContextDictionary.has(tokenProviderConfiguration.servicePrincipalId)) {
                var authContext = new oauthTokenProvider_AdalAuthContext(adalModule.inject(AdalAuthContextManager.convertTokenParametersToConfig(tokenProviderConfiguration)), tokenProviderConfiguration.aadUserId);
                _this._authContextDictionary.set(tokenProviderConfiguration.servicePrincipalId, authContext);
            }
            return _this._authContextDictionary.get(tokenProviderConfiguration.servicePrincipalId);
        });
    };
    AdalAuthContextManager.prototype._loadAdalJs = function () {
        return __webpack_require__.e/* import() */(1).then(__webpack_require__.bind(null, 5));
    };
    AdalAuthContextManager.usePromptQueryParamKillSwitchGuid = sp_core_library_["Guid"].parse('9a8c4bb8-88c1-4083-ae41-044320eba9d7');
    return AdalAuthContextManager;
}());
/* harmony default export */ var oauthTokenProvider_AdalAuthContextManager = (AdalAuthContextManager_AdalAuthContextManager);

// CONCATENATED MODULE: ./lib/oauthTokenProvider/AadTokenProvider.js




var AadTokenProvider_TokenAcquisitionEventArgs =  (function (_super) {
    __extends(TokenAcquisitionEventArgs, _super);
    function TokenAcquisitionEventArgs(message, redirectUrl) {
        var _this = _super.call(this) || this;
        _this.message = message;
        _this.redirectUrl = redirectUrl;
        return _this;
    }
    return TokenAcquisitionEventArgs;
}(sp_core_library_["SPEventArgs"]));

var AadTokenProvider_AadTokenProvider =  (function () {
    function AadTokenProvider(configuration, oboConfiguration) {
        sp_core_library_["Validate"].isNonemptyString(configuration.aadInstanceUrl, 'aadInstanceUrl');
        sp_core_library_["Validate"].isNonemptyString(configuration.aadTenantId, 'aadTenantId');
        sp_core_library_["Validate"].isNonemptyString(configuration.redirectUri, 'redirectUri');
        sp_core_library_["Validate"].isNonemptyString(configuration.servicePrincipalId, 'servicePrincipalId');
        this._defaultConfiguration = configuration;
        this._fetchQueue = Promise.resolve();
        this._oboConfiguration = oboConfiguration;
        this._tokenAcquisitionEvent = new sp_core_library_["SPEvent"](AadTokenProvider._tokenAcquisitionEventId);
    }
    AadTokenProvider.prototype.getToken = function (resourceEndpoint) {
        if (this._defaultConfiguration.servicePrincipalId === sp_core_library_["Guid"].empty.toString()) {
            return Promise.reject(new Error(SPHttpStrings_resx.servicePrincipalNotAvaliableError));
        }
        return this._getTokenInternal(resourceEndpoint, this._defaultConfiguration);
    };
    AadTokenProvider.prototype._getTokenInternal = function (resourceEndpoint, configuration) {
        var _this = this;
        var tokenProviderConfig = configuration || this._defaultConfiguration;
        if (!this._authContextManager) {
            this._authContextManager = new oauthTokenProvider_AdalAuthContextManager();
        }
        var getAuthContextPromise = function () { return _this._authContextManager.getAuthContext(tokenProviderConfig, _this._oboConfiguration); };
        this._fetchQueue =
            this._fetchQueue
                .then(getAuthContextPromise, getAuthContextPromise)
                .then(function (authContext) { return authContext.getToken(resourceEndpoint); });
        return this._fetchQueue;
    };
    Object.defineProperty(AadTokenProvider.prototype, "tokenAcquisitionEvent", {
        get: function () {
            return this._tokenAcquisitionEvent;
        },
        enumerable: true,
        configurable: true
    });
    AadTokenProvider._tokenAcquisitionEventId = 'tokenAcquisitionFailure';
    return AadTokenProvider;
}());
/* harmony default export */ var oauthTokenProvider_AadTokenProvider = (AadTokenProvider_AadTokenProvider);

// CONCATENATED MODULE: ./lib/aadHttpClient/AadHttpClientConfiguration.js



var AadHttpClientConfiguration_AadHttpClientConfiguration =  (function (_super) {
    __extends(AadHttpClientConfiguration, _super);
    function AadHttpClientConfiguration(flags, overrideFlags) {
        return _super.call(this, flags, overrideFlags) || this;
    }
    AadHttpClientConfiguration.prototype.overrideWith = function (sourceFlags) {
        return new AadHttpClientConfiguration(this.flags, sourceFlags);
    };
    return AadHttpClientConfiguration;
}(httpClient_HttpClientConfiguration));
/* harmony default export */ var aadHttpClient_AadHttpClientConfiguration = (AadHttpClientConfiguration_AadHttpClientConfiguration);
var AadHttpClientConfiguration_predefinedConfigurations = {
    v1: new AadHttpClientConfiguration_AadHttpClientConfiguration(httpClient_HttpClient.configurations.v1)
};

// CONCATENATED MODULE: ./lib/aadHttpClient/AadHttpClient.js






var AadHttpClient_AadHttpClient =  (function () {
    function AadHttpClient(serviceScope, resourceEndpoint, options) {
        var _this = this;
        sp_core_library_["Validate"].isNotNullOrUndefined(serviceScope, 'serviceScope');
        sp_core_library_["Validate"].isNotNullOrUndefined(resourceEndpoint, 'resourceUrl');
        this._resourceUrl = resourceEndpoint;
        this._serviceScope = serviceScope;
        this._aadTokenProvider = options && options.tokenProvider || oauthTokenProvider_AadTokenProviders.configurable;
        this._aadTokenConfiguration = options && options.configuration;
        serviceScope.whenFinished(function () {
            _this._fetchProvider = serviceScope.consume(fetchProviderServiceKey);
        });
    }
    AadHttpClient.prototype.fetch = function (url, configuration, options) {
        var _this = this;
        var tokenFetchPromise = this._aadTokenConfiguration ?
            this._aadTokenProvider._getTokenInternal(this._resourceUrl, this._aadTokenConfiguration) :
            this._aadTokenProvider.getToken(this._resourceUrl);
        return tokenFetchPromise.then(function (token) {
            if (!options.headers) {
                options.headers = new Headers();
            }
            else {
                options.headers = new Headers(options.headers);
            }
            options.headers.append('Authorization', 'Bearer ' + token);
            return httpClient_HttpClientHelper.fetchCore(configuration, new Request(url, options), _this._serviceScope, _this._fetchProvider, AadHttpClient._className);
        }).then(function (value) {
            return new httpClient_HttpClientResponse(value);
        });
    };
    AadHttpClient.prototype.get = function (url, configuration, options) {
        return this.fetch(url, configuration, httpClient_HttpClientHelper.overrideHttpMethod(options, 'GET'));
    };
    AadHttpClient.prototype.post = function (url, configuration, options) {
        return this.fetch(url, configuration, httpClient_HttpClientHelper.overrideHttpMethod(options, 'POST'));
    };
    AadHttpClient.configurations = AadHttpClientConfiguration_predefinedConfigurations;
    AadHttpClient._className = 'AadHttpClient';
    return AadHttpClient;
}());
/* harmony default export */ var aadHttpClient_AadHttpClient = (AadHttpClient_AadHttpClient);

// CONCATENATED MODULE: ./lib/aadHttpClient/AadHttpClientFactory.js



var AadHttpClientFactory_AadHttpClientFactory =  (function () {
    function AadHttpClientFactory(serviceScope) {
        this._serviceScope = serviceScope;
    }
    AadHttpClientFactory.prototype.getClient = function (resourceEndpoint) {
        return Promise.resolve(new aadHttpClient_AadHttpClient(this._serviceScope, resourceEndpoint));
    };
    AadHttpClientFactory.prototype._getStandardClient = function (resourceEndpoint) {
        return Promise.resolve(new aadHttpClient_AadHttpClient(this._serviceScope, resourceEndpoint, { configuration: oauthTokenProvider_AadTokenProviders.preAuthorizedConfiguration }));
    };
    AadHttpClientFactory.serviceKey = sp_core_library_["ServiceKey"].create('sp-http:AadHttpClientFactory', AadHttpClientFactory);
    return AadHttpClientFactory;
}());
/* harmony default export */ var aadHttpClient_AadHttpClientFactory = (AadHttpClientFactory_AadHttpClientFactory);

// CONCATENATED MODULE: ./lib/oauthTokenProvider/AadTokenProviderFactory.js


var AadTokenProviderFactory_AadTokenProviderFactory =  (function () {
    function AadTokenProviderFactory() {
    }
    AadTokenProviderFactory.prototype.getTokenProvider = function () {
        return Promise.resolve(oauthTokenProvider_AadTokenProviders.configurable);
    };
    AadTokenProviderFactory.serviceKey = sp_core_library_["ServiceKey"].create('sp-http:AadTokenProviderFactory', AadTokenProviderFactory);
    return AadTokenProviderFactory;
}());
/* harmony default export */ var oauthTokenProvider_AadTokenProviderFactory = (AadTokenProviderFactory_AadTokenProviderFactory);

// CONCATENATED MODULE: ./lib/msGraphClient/MSGraphClient.js





var MSGraphClient_MSGraphClient =  (function () {
    function MSGraphClient(serviceScope) {
        var _this = this;
        serviceScope.whenFinished(function () {
            MSGraphClient._graphBaseUrl = serviceScope.consume(graphHttpClient_GraphHttpClientContext.serviceKey).getGraphEndpointUrl();
            if (!MSGraphClient._instance) {
                MSGraphClient._instance = _this._createGraphClientInstance(oauthTokenProvider_AadTokenProviders.configurable);
            }
        });
    }
    MSGraphClient.prototype.api = function (path, config) {
        sp_core_library_["Validate"].isNonemptyString(path, 'path');
        MSGraphClient._instance.config = Object.assign({}, MSGraphClient._originalConfig);
        if (config) {
            for (var key in config) {
                if (config[key]) {
                    MSGraphClient._instance.config[key] = config[key];
                }
            }
        }
        return MSGraphClient._instance.api(path);
    };
    MSGraphClient.prototype._createGraphClientInstance = function (tokenProvider) {
        var _this = this;
        var graphClientModule;
        if (!(MSGraphClient._window.MicrosoftGraph && MSGraphClient._window.MicrosoftGraph.Client)) {
            throw new Error(SPHttpStrings_resx.graphClientInitializationError);
        }
        else {
            graphClientModule = MSGraphClient._window.MicrosoftGraph.Client;
            MSGraphClient._window.MicrosoftGraph = undefined;
        }
        var graphClient = graphClientModule.init({
            authProvider: function (done) {
                _this._getOAuthToken(tokenProvider).then(function (token) {
                    done(undefined , token);
                }).catch(function (e) {
                    done(e, '');
                });
            },
            baseUrl: MSGraphClient._graphBaseUrl
        });
        MSGraphClient._originalConfig = graphClient.config;
        return graphClient;
    };
    MSGraphClient.prototype._getOAuthToken = function (tokenProvider) {
        var qosMonitor = new sp_diagnostics_["_QosMonitor"]('MSGraphClient.FetchGraphToken');
        return tokenProvider.getToken(MSGraphClient._graphBaseUrl).then(function (response) {
            qosMonitor.writeSuccess();
            return response;
        }).catch(function (error) {
            qosMonitor.writeUnexpectedFailure('FetchGraphToken', error);
            throw error;
        });
    };
    MSGraphClient._window = window;
    return MSGraphClient;
}());
/* harmony default export */ var msGraphClient_MSGraphClient = (MSGraphClient_MSGraphClient);

// CONCATENATED MODULE: ./lib/msGraphClient/MSGraphClientFactory.js


var MSGraphClientFactory_MSGraphClientFactory =  (function () {
    function MSGraphClientFactory(serviceScope) {
        this._serviceScope = serviceScope;
    }
    MSGraphClientFactory.prototype.getClient = function () {
        var _this = this;
        if (!msGraphClient_MSGraphClient._instance) {
            return __webpack_require__.e/* import() */(0).then(__webpack_require__.bind(null, 6))
                .then(function () {
                return new msGraphClient_MSGraphClient(_this._serviceScope);
            });
        }
        else {
            return Promise.resolve(new msGraphClient_MSGraphClient(this._serviceScope));
        }
    };
    MSGraphClientFactory.serviceKey = sp_core_library_["ServiceKey"].create('sp-http:MSGraphClientFactory', MSGraphClientFactory);
    return MSGraphClientFactory;
}());
/* harmony default export */ var msGraphClient_MSGraphClientFactory = (MSGraphClientFactory_MSGraphClientFactory);

// CONCATENATED MODULE: ./lib/index.js
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "HttpClient", function() { return httpClient_HttpClient; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "HttpClientConfiguration", function() { return httpClient_HttpClientConfiguration; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "HttpClientResponse", function() { return httpClient_HttpClientResponse; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "DigestCache", function() { return spHttpClient_DigestCache; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "SPHttpClient", function() { return spHttpClient_SPHttpClient; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "SPHttpClientCommonConfiguration", function() { return spHttpClient_SPHttpClientCommonConfiguration; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "SPHttpClientConfiguration", function() { return spHttpClient_SPHttpClientConfiguration; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "SPHttpClientResponse", function() { return spHttpClient_SPHttpClientResponse; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "SPHttpClientBatchConfiguration", function() { return spHttpClient_SPHttpClientBatchConfiguration; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "SPHttpClientBatch", function() { return spHttpClient_SPHttpClientBatch; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "ODataVersion", function() { return spHttpClient_ODataVersion; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "OAuthTokenProvider", function() { return oauthTokenProvider_OAuthTokenProvider; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "_AadTokenProviders", function() { return oauthTokenProvider_AadTokenProviders; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "_AadConstants", function() { return oauthTokenProvider_AadConstants; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "GraphHttpClient", function() { return graphHttpClient_GraphHttpClient; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "GraphHttpClientResponse", function() { return graphHttpClient_GraphHttpClientResponse; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "GraphHttpClientConfiguration", function() { return graphHttpClient_GraphHttpClientConfiguration; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "_GraphHttpClientContext", function() { return graphHttpClient_GraphHttpClientContext; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "AadTokenProvider", function() { return oauthTokenProvider_AadTokenProvider; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "TokenAcquisitionEventArgs", function() { return AadTokenProvider_TokenAcquisitionEventArgs; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "AadHttpClient", function() { return aadHttpClient_AadHttpClient; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "AadHttpClientConfiguration", function() { return aadHttpClient_AadHttpClientConfiguration; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "AadHttpClientFactory", function() { return aadHttpClient_AadHttpClientFactory; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "AadTokenProviderFactory", function() { return oauthTokenProvider_AadTokenProviderFactory; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "MSGraphClient", function() { return msGraphClient_MSGraphClient; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "GraphRequest", function() { return /* Cannot get final name for export "GraphRequest" in "./lib/msGraphClient/MSGraphClient.js" (known exports: default, known reexports: ) */ undefined; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "MSGraphClientFactory", function() { return msGraphClient_MSGraphClientFactory; });



























/***/ }),
/* 3 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_3__;

/***/ })
/******/ ])}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));;


/***/ }),
/* 1 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_1__;

/***/ }),
/* 2 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_2__;

/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = (function() {
  var strings = {
    "_+tvmKa3YEOqWGKKXzwjtaw": {
      "additionalCredentialsWarning": "Additional credentials are required to show this page correctly.",
      "servicePrincipalNotAvaliableError": "The SharePoint Online Web Application Service Principal hasn't been provisioned yet. Please contact your Tenant Administrator.",
      "graphClientInitializationError": "MSGraphClient cannot be constructed due to an unknown failure"
    }
  };

  strings.default = strings;
  return strings;
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ })
/******/ ])});;
//# sourceMappingURL=sp-http_en-us.js.map
(function(){
if (!window.__setWebpackPublicPathLoaderSrcRegistry__) window.__setWebpackPublicPathLoaderSrcRegistry__={};
var scripts = document.getElementsByTagName('script');
if (scripts && scripts.length) {
  for (var i = 0; i < scripts.length; i++) {
    if (!scripts[i]) continue;
    var path = scripts[i].getAttribute('src');
    if (path) window.__setWebpackPublicPathLoaderSrcRegistry__[path]=true;
  }
}
})();