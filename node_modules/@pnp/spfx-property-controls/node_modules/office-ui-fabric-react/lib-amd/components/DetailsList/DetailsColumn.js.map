{"version":3,"file":"DetailsColumn.js","sourceRoot":"../src/","sources":["components/DetailsList/DetailsColumn.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport * as stylesImport from './DetailsHeader.scss';\r\nconst styles: any = stylesImport;\r\nimport { Icon } from '../../Icon';\r\nimport { BaseComponent, css, IRenderFunction, createRef, IDisposable } from '../../Utilities';\r\nimport { IColumn, ColumnActionsMode } from './DetailsList.types';\r\nimport { Layer } from '../../Layer';\r\nimport { ITooltipHostProps } from '../../Tooltip';\r\nimport { IDragDropHelper, IDragDropOptions } from './../../utilities/dragdrop/interfaces';\r\n\r\nconst INNER_PADDING = 16; // Account for padding around the cell.\r\nconst ISPADDED_WIDTH = 24;\r\nconst MOUSEDOWN_PRIMARY_BUTTON = 0; // for mouse down event we are using ev.button property, 0 means left button\r\n\r\nexport interface IDetailsColumnProps extends React.Props<DetailsColumn> {\r\n  componentRef?: () => void;\r\n  column: IColumn;\r\n  columnIndex: number;\r\n  parentId?: string;\r\n  onRenderColumnHeaderTooltip?: IRenderFunction<ITooltipHostProps>;\r\n  onColumnClick?: (ev: React.MouseEvent<HTMLElement>, column: IColumn) => void;\r\n  onColumnContextMenu?: (column: IColumn, ev: React.MouseEvent<HTMLElement>) => void;\r\n  dragDropHelper?: IDragDropHelper | null;\r\n  isDraggable?: boolean;\r\n  // @deprecated, use updateDragInfo\r\n  setDraggedItemIndex?: (itemIndex: number) => void;\r\n  updateDragInfo?: (props: { itemIndex: number }, event?: MouseEvent) => void;\r\n  isDropped?: boolean;\r\n}\r\n\r\nexport class DetailsColumn extends BaseComponent<IDetailsColumnProps> {\r\n  private _root: any;\r\n  private _dragDropSubscription: IDisposable;\r\n\r\n  constructor(props: IDetailsColumnProps) {\r\n    super(props);\r\n\r\n    this._root = createRef();\r\n    this._onDragStart = this._onDragStart.bind(this);\r\n    this._onDragEnd = this._onDragEnd.bind(this);\r\n    this._onRootMouseDown = this._onRootMouseDown.bind(this);\r\n    this._updateHeaderDragInfo = this._updateHeaderDragInfo.bind(this);\r\n  }\r\n\r\n  public render() {\r\n    const { column, columnIndex, parentId, isDraggable } = this.props;\r\n    const { onRenderColumnHeaderTooltip = this._onRenderColumnHeaderTooltip } = this.props;\r\n\r\n    return (\r\n      <div\r\n        key={ column.key }\r\n        ref={ this._root }\r\n        role={ 'columnheader' }\r\n        aria-sort={ column.isSorted ? (column.isSortedDescending ? 'descending' : 'ascending') : 'none' }\r\n        aria-colindex={ columnIndex + 1 }\r\n        className={ css(\r\n          'ms-DetailsHeader-cell',\r\n          styles.cell,\r\n          column.headerClassName,\r\n          column.columnActionsMode !== ColumnActionsMode.disabled && 'is-actionable ' + styles.cellIsActionable,\r\n          !column.name && 'is-empty ' + styles.cellIsEmpty,\r\n          (column.isSorted || column.isGrouped || column.isFiltered) && 'is-icon-visible',\r\n          column.isPadded && styles.cellWrapperPadded\r\n        ) }\r\n        data-is-draggable={ isDraggable }\r\n        draggable={ isDraggable }\r\n        style={ { width: column.calculatedWidth! + INNER_PADDING + (column.isPadded ? ISPADDED_WIDTH : 0) } }\r\n        data-automationid={ 'ColumnsHeaderColumn' }\r\n        data-item-key={ column.key }\r\n      >\r\n        { isDraggable && <Icon iconName={ 'GripperBarVertical' } className={ css(styles.gripperBarVerticalStyle) } /> }\r\n        { onRenderColumnHeaderTooltip(\r\n          {\r\n            hostClassName: css(styles.cellTooltip),\r\n            id: `${parentId}-${column.key}-tooltip`,\r\n            setAriaDescribedBy: false,\r\n            content: column.columnActionsMode !== ColumnActionsMode.disabled ? column.ariaLabel : '',\r\n            children: (\r\n              <span\r\n                id={ `${parentId}-${column.key}` }\r\n                aria-label={ column.isIconOnly ? column.name : undefined }\r\n                aria-labelledby={ column.isIconOnly ? undefined : `${parentId}-${column.key}-name ` }\r\n                className={ css('ms-DetailsHeader-cellTitle', styles.cellTitle) }\r\n                data-is-focusable={ column.columnActionsMode !== ColumnActionsMode.disabled }\r\n                role={ column.columnActionsMode !== ColumnActionsMode.disabled ? 'button' : undefined }\r\n                aria-describedby={\r\n                  this.props.onRenderColumnHeaderTooltip ? `${parentId}-${column.key}-tooltip` : undefined\r\n                }\r\n                onContextMenu={ this._onColumnContextMenu.bind(this, column) }\r\n                onClick={ this._onColumnClick.bind(this, column) }\r\n                aria-haspopup={ column.columnActionsMode === ColumnActionsMode.hasDropdown }\r\n              >\r\n                <span\r\n                  id={ `${parentId}-${column.key}-name` }\r\n                  className={ css('ms-DetailsHeader-cellName', styles.cellName, {\r\n                    [styles.iconOnlyHeader]: column.isIconOnly\r\n                  }) }\r\n                >\r\n                  { (column.iconName || column.iconClassName) && (\r\n                    <Icon className={ css(styles.nearIcon, column.iconClassName) } iconName={ column.iconName } />\r\n                  ) }\r\n\r\n                  { !column.isIconOnly ? column.name : undefined }\r\n                </span>\r\n\r\n                { column.isFiltered && (\r\n                  <Icon ariaLabel={ column.filterAriaLabel } className={ styles.nearIcon } iconName='Filter' />\r\n                ) }\r\n\r\n                { column.isSorted && (\r\n                  <Icon\r\n                    ariaLabel={\r\n                      column.isSortedDescending ?\r\n                        column.sortDescendingAriaLabel :\r\n                        column.sortAscendingAriaLabel\r\n                    }\r\n                    className={ css(styles.nearIcon, styles.sortIcon) }\r\n                    iconName={ column.isSortedDescending ? 'SortDown' : 'SortUp' }\r\n                  />\r\n                ) }\r\n\r\n                { column.isGrouped && (\r\n                  <Icon ariaLabel={ column.groupAriaLabel } className={ styles.nearIcon } iconName='GroupedDescending' />\r\n                ) }\r\n\r\n                { column.columnActionsMode === ColumnActionsMode.hasDropdown && !column.isIconOnly && (\r\n                  <Icon\r\n                    aria-hidden={ true }\r\n                    className={ css('ms-DetailsHeader-filterChevron', styles.filterChevron) }\r\n                    iconName='ChevronDown'\r\n                  />\r\n                ) }\r\n              </span>\r\n            )\r\n          },\r\n          this._onRenderColumnHeaderTooltip\r\n        ) }\r\n        {\r\n          column.ariaLabel && !this.props.onRenderColumnHeaderTooltip ? (\r\n            <Layer>\r\n              <label\r\n                key={ `${column.key}_label` }\r\n                id={ `${parentId}-${column.key}-tooltip` }\r\n                className={ styles.accessibleLabel }\r\n              >\r\n                { column.ariaLabel }\r\n              </label>\r\n            </Layer>\r\n          ) : null\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  public componentDidMount(): void {\r\n    if (this._dragDropSubscription) {\r\n      this._dragDropSubscription.dispose();\r\n      delete this._dragDropSubscription;\r\n    }\r\n\r\n    if (this.props.dragDropHelper && this.props.isDraggable!) {\r\n      this._dragDropSubscription = this.props.dragDropHelper.subscribe(\r\n        this._root.current as HTMLElement,\r\n        this._events,\r\n        this._getColumnDragDropOptions()\r\n      );\r\n\r\n      // We need to use native on this to avoid MarqueeSelection from handling the event before us.\r\n      this._events.on(this._root.current, 'mousedown', this._onRootMouseDown);\r\n    }\r\n    if (this.props.isDropped) {\r\n      if (this._root!.current!) {\r\n        this._root!.current!.classList!.add(styles.borderAfterDropping);\r\n      }\r\n      setTimeout(() => {\r\n        if (this._root!.current!) {\r\n          this._root!.current!.classList!.remove(styles.borderAfterDropping);\r\n        }\r\n      }, 1500);\r\n    }\r\n  }\r\n\r\n  public componentWillUnmount(): void {\r\n    if (this._dragDropSubscription) {\r\n      this._dragDropSubscription.dispose();\r\n      delete this._dragDropSubscription;\r\n    }\r\n  }\r\n\r\n  public componentDidUpdate(): void {\r\n    if (!this._dragDropSubscription && this.props.dragDropHelper && this.props.isDraggable!) {\r\n      this._dragDropSubscription = this.props.dragDropHelper.subscribe(\r\n        this._root.value as HTMLElement,\r\n        this._events,\r\n        this._getColumnDragDropOptions()\r\n      );\r\n\r\n      // We need to use native on this to avoid MarqueeSelection from handling the event before us.\r\n      this._events.on(this._root.current, 'mousedown', this._onRootMouseDown);\r\n    }\r\n    if (this._dragDropSubscription && !this.props.isDraggable!) {\r\n      this._dragDropSubscription.dispose();\r\n      this._events.off(this._root.current, 'mousedown');\r\n      delete this._dragDropSubscription;\r\n    }\r\n  }\r\n\r\n  private _onRenderColumnHeaderTooltip = (\r\n    tooltipHostProps: ITooltipHostProps,\r\n    defaultRender?: IRenderFunction<ITooltipHostProps>\r\n  ): JSX.Element => {\r\n    return <span className={ tooltipHostProps.hostClassName }>{ tooltipHostProps.children }</span>;\r\n  }\r\n\r\n  private _onColumnClick(column: IColumn, ev: React.MouseEvent<HTMLElement>): void {\r\n    const { onColumnClick } = this.props;\r\n    if (column.onColumnClick) {\r\n      column.onColumnClick(ev, column);\r\n    }\r\n    if (onColumnClick) {\r\n      onColumnClick(ev, column);\r\n    }\r\n  }\r\n\r\n  private _getColumnDragDropOptions(): IDragDropOptions {\r\n    const { columnIndex } = this.props;\r\n    const options = {\r\n      selectionIndex: columnIndex,\r\n      context: { data: columnIndex, index: columnIndex },\r\n      canDrag: () => this.props.isDraggable!,\r\n      canDrop: () => false,\r\n      onDragStart: this._onDragStart,\r\n      updateDropState: () => undefined,\r\n      onDrop: () => undefined,\r\n      onDragEnd: this._onDragEnd\r\n    };\r\n    return options;\r\n  }\r\n\r\n  private _onDragStart(item?: any, itemIndex?: number, selectedItems?: any[], event?: MouseEvent): void {\r\n    if (itemIndex) {\r\n      this._updateHeaderDragInfo(itemIndex);\r\n      this._root.current.classList.add(styles.borderWhileDragging);\r\n    }\r\n  }\r\n\r\n  private _onDragEnd(item?: any, event?: MouseEvent): void {\r\n    if (event) {\r\n      this._updateHeaderDragInfo(-1, event);\r\n    }\r\n    this._root.current.classList.remove(styles.borderWhileDragging);\r\n  }\r\n\r\n  private _updateHeaderDragInfo(itemIndex: number, event?: MouseEvent) {\r\n    if (this.props.setDraggedItemIndex) {\r\n      this.props.setDraggedItemIndex(itemIndex);\r\n    }\r\n    if (this.props.updateDragInfo) {\r\n      this.props.updateDragInfo({ itemIndex }, event);\r\n    }\r\n  }\r\n\r\n  private _onColumnContextMenu(column: IColumn, ev: React.MouseEvent<HTMLElement>): void {\r\n    const { onColumnContextMenu } = this.props;\r\n    if (column.onColumnContextMenu) {\r\n      column.onColumnContextMenu(column, ev);\r\n      ev.preventDefault();\r\n    }\r\n    if (onColumnContextMenu) {\r\n      onColumnContextMenu(column, ev);\r\n      ev.preventDefault();\r\n    }\r\n  }\r\n\r\n  private _onRootMouseDown(ev: MouseEvent): void {\r\n    const { isDraggable } = this.props;\r\n    // Ignore anything except the primary button.\r\n    if (isDraggable && ev.button === MOUSEDOWN_PRIMARY_BUTTON) {\r\n      ev.stopPropagation();\r\n    }\r\n  }\r\n}\r\n"]}