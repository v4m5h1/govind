{"version":3,"file":"EditingItem.js","sourceRoot":"../src/","sources":["components/SelectedItemsList/SelectedPeopleList/Items/EditingItem.tsx"],"names":[],"mappings":"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","sourcesContent":["/* tslint:disable */\r\nimport * as React from 'react';\r\n/* tslint:enable */\r\nimport {\r\n  BaseComponent,\r\n  KeyCodes,\r\n  getId,\r\n  getNativeProps,\r\n  inputProperties,\r\n  css,\r\n  createRef\r\n} from '../../../../Utilities';\r\nimport { FloatingPeoplePicker, IBaseFloatingPickerProps } from '../../../../FloatingPicker';\r\nimport { ISelectedPeopleItemProps } from '../SelectedPeopleList';\r\nimport { IExtendedPersonaProps } from '../SelectedPeopleList';\r\nimport { IPeoplePickerItemState } from './ExtendedSelectedItem';\r\nimport { IPersonaProps } from '../../../Persona';\r\n\r\nimport * as stylesImport from './EditingItem.scss';\r\n\r\n// tslint:disable-next-line:no-any\r\nconst styles: any = stylesImport;\r\n\r\nexport interface IEditingSelectedPeopleItemProps extends ISelectedPeopleItemProps {\r\n  // tslint:disable-next-line:no-any\r\n  onEditingComplete: (oldItem: any, newItem: any) => void;\r\n  onRenderFloatingPicker?: (props: IBaseFloatingPickerProps<IPersonaProps>) => JSX.Element;\r\n  floatingPickerProps?: IBaseFloatingPickerProps<IPersonaProps>;\r\n  getEditingItemText?: (item: IExtendedPersonaProps) => string;\r\n}\r\n\r\nexport class EditingItem extends BaseComponent<IEditingSelectedPeopleItemProps, IPeoplePickerItemState> {\r\n  private _editingInput: HTMLInputElement;\r\n  private _editingFloatingPicker = createRef<FloatingPeoplePicker>();\r\n  private _onRenderFloatingPicker: (props: IBaseFloatingPickerProps<IExtendedPersonaProps>) => JSX.Element;\r\n  private _floatingPickerProps: IBaseFloatingPickerProps<IExtendedPersonaProps>;\r\n\r\n  constructor(props: IEditingSelectedPeopleItemProps) {\r\n    super(props);\r\n    this.state = { contextualMenuVisible: false };\r\n    this._onRenderFloatingPicker = this.props.onRenderFloatingPicker as\r\n      (props: IBaseFloatingPickerProps<IExtendedPersonaProps>) => JSX.Element;\r\n    this._floatingPickerProps = this.props.floatingPickerProps as IBaseFloatingPickerProps<IExtendedPersonaProps>;\r\n  }\r\n\r\n  public componentDidMount(): void {\r\n    const getEditingItemText = this.props.getEditingItemText as (item: IExtendedPersonaProps) => string;\r\n    const itemText = getEditingItemText(this.props.item);\r\n    this._editingFloatingPicker.current && this._editingFloatingPicker.current.onQueryStringChanged(itemText);\r\n    this._editingInput.value = itemText;\r\n    this._editingInput.focus();\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    const itemId = getId();\r\n    const nativeProps = getNativeProps(this.props, inputProperties);\r\n    return (\r\n      <div aria-labelledby={ 'editingItemPersona-' + itemId } className={ css('ms-EditingItem', styles.editingContainer) }>\r\n        <input\r\n          { ...nativeProps }\r\n          ref={ this._resolveInputRef }\r\n          autoCapitalize={ 'off' }\r\n          autoComplete={ 'off' }\r\n          onChange={ this._onInputChange }\r\n          onKeyDown={ this._onInputKeyDown }\r\n          onBlur={ this._onInputBlur }\r\n          onClick={ this._onInputClick }\r\n          data-lpignore={ true }\r\n          className={ styles.editingInput }\r\n          id={ itemId }\r\n        />\r\n        { this._renderEditingSuggestions() }\r\n      </div>);\r\n  }\r\n\r\n  private _renderEditingSuggestions = (): JSX.Element => {\r\n    const onRenderFloatingPicker = this._onRenderFloatingPicker;\r\n    return (onRenderFloatingPicker({\r\n      componentRef: this._editingFloatingPicker,\r\n      onChange: this._onSuggestionSelected,\r\n      inputElement: this._editingInput,\r\n      selectedItems: [],\r\n      ...this._floatingPickerProps\r\n    }));\r\n  }\r\n\r\n  private _resolveInputRef = (ref: HTMLInputElement): void => {\r\n    this._editingInput = ref;\r\n\r\n    this.forceUpdate(() => { this._editingInput.focus(); });\r\n  }\r\n\r\n  private _onInputClick = (): void => {\r\n    this._editingFloatingPicker.current && this._editingFloatingPicker.current.showPicker(true /*updatevalue*/);\r\n  }\r\n\r\n  private _onInputBlur = (ev: React.FocusEvent<HTMLElement>): void => {\r\n    if (this._editingFloatingPicker.current && ev.relatedTarget !== null) {\r\n      const target = ev.relatedTarget as HTMLElement;\r\n      if (target.className.indexOf('ms-Suggestions-itemButton') === -1 && target.className.indexOf('ms-Suggestions-sectionButton') === -1) {\r\n        this._editingFloatingPicker.current.forceResolveSuggestion();\r\n      }\r\n    }\r\n  }\r\n\r\n  private _onInputChange = (ev: React.FormEvent<HTMLElement>): void => {\r\n    const value: string = (ev.target as HTMLInputElement).value;\r\n\r\n    if (value === '') {\r\n      if (this.props.onRemoveItem) {\r\n        this.props.onRemoveItem();\r\n      }\r\n    } else {\r\n      this._editingFloatingPicker.current && this._editingFloatingPicker.current.onQueryStringChanged(value);\r\n    }\r\n  }\r\n\r\n  private _onInputKeyDown(ev: React.KeyboardEvent<HTMLInputElement>): void {\r\n    if (ev.which === KeyCodes.backspace || ev.which === KeyCodes.del) {\r\n      ev.stopPropagation();\r\n    }\r\n  }\r\n\r\n  private _onSuggestionSelected = (item: IExtendedPersonaProps): void => {\r\n    this.props.onEditingComplete(this.props.item, item);\r\n  }\r\n}"]}